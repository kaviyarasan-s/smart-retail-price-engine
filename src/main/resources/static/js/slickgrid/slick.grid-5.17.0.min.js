/**
 * Minified by jsDelivr using Terser v5.39.0.
 * Original file: /npm/slickgrid@5.17.0/dist/browser/slick.grid.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";(()=>{var e=Object.defineProperty,t=(t,i,o)=>((t,i,o)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[i]=o)(t,"symbol"!=typeof i?i+"":i,o),i=Slick.BindingEventService,o=Slick.ColAutosizeMode,s=Slick.Event,l=Slick.EventData,n=Slick.GlobalEditorLock,r=Slick.GridAutosizeColsMode,h=Slick.keyCode,a=Slick.preClickClassName,d=Slick.Range,c=Slick.RowSelectionMode,u=Slick.CellSelectionMode,p=Slick.ValueFilterMode,m=Slick.Utils,w=Slick.SelectionUtils,g=Slick.WidthEvalMode,v=Slick.Draggable,C=Slick.MouseWheel,f=Slick.Resizable,_=Slick.DragExtendHandle;window.Slick&&m.extend(Slick,{Grid:class{constructor(e,l,h,a,d){if(this.container=e,this.data=l,this.columns=h,this.externalPubSub=d,t(this,"slickGridVersion","5.17.0"),t(this,"cid",""),t(this,"onActiveCellChanged"),t(this,"onActiveCellPositionChanged"),t(this,"onAddNewRow"),t(this,"onAfterSetColumns"),t(this,"onAutosizeColumns"),t(this,"onBeforeAppendCell"),t(this,"onBeforeCellEditorDestroy"),t(this,"onBeforeColumnsResize"),t(this,"onBeforeDestroy"),t(this,"onBeforeEditCell"),t(this,"onBeforeFooterRowCellDestroy"),t(this,"onBeforeHeaderCellDestroy"),t(this,"onBeforeHeaderRowCellDestroy"),t(this,"onBeforeRemoveCachedRow"),t(this,"onBeforeSetColumns"),t(this,"onBeforeSort"),t(this,"onBeforeUpdateColumns"),t(this,"onCellChange"),t(this,"onCellCssStylesChanged"),t(this,"onClick"),t(this,"onColumnsReordered"),t(this,"onColumnsDrag"),t(this,"onColumnsResized"),t(this,"onColumnsResizeDblClick"),t(this,"onCompositeEditorChange"),t(this,"onContextMenu"),t(this,"onDrag"),t(this,"onDblClick"),t(this,"onDragInit"),t(this,"onDragStart"),t(this,"onDragEnd"),t(this,"onFooterClick"),t(this,"onFooterContextMenu"),t(this,"onFooterRowCellRendered"),t(this,"onHeaderCellRendered"),t(this,"onHeaderClick"),t(this,"onHeaderContextMenu"),t(this,"onHeaderMouseEnter"),t(this,"onHeaderMouseLeave"),t(this,"onHeaderRowCellRendered"),t(this,"onHeaderRowMouseEnter"),t(this,"onHeaderRowMouseLeave"),t(this,"onPreHeaderContextMenu"),t(this,"onPreHeaderClick"),t(this,"onKeyDown"),t(this,"onMouseEnter"),t(this,"onMouseLeave"),t(this,"onRendered"),t(this,"onScroll"),t(this,"onSelectedRowsChanged"),t(this,"onSetOptions"),t(this,"onActivateChangedOptions"),t(this,"onSort"),t(this,"onValidationError"),t(this,"onViewportChanged"),t(this,"onDragReplaceCells"),t(this,"scrollbarDimensions"),t(this,"maxSupportedCssHeight"),t(this,"canvas",null),t(this,"canvas_context",null),t(this,"_options"),t(this,"_defaults",{invalidColumnFreezePickerCallback:e=>alert(e),invalidColumnFreezeWidthCallback:e=>alert(e),invalidColumnFreezeWidthMessage:"[SlickGrid] You are trying to freeze/pin more columns than the grid can support. Make sure to have less columns pinned (on the left) than the actual visible grid width.",invalidColumnFreezePickerMessage:'[SlickGrid] Action not allowed and aborted, you need to have at least one or more column on the right section of the column freeze/pining. You could alternatively "Unfreeze all the columns" before trying again.',alwaysShowVerticalScroll:!1,alwaysAllowHorizontalScroll:!1,explicitInitialization:!1,rowHeight:25,defaultColumnWidth:80,enableHtmlRendering:!0,enableAddRow:!1,leaveSpaceForNewRows:!1,editable:!1,autoEdit:!0,autoEditNewRow:!0,autoCommitEdit:!1,suppressActiveCellChangeOnEdit:!1,enableCellNavigation:!0,enableColumnReorder:!0,unorderableColumnCssClass:"unorderable",asyncEditorLoading:!1,asyncEditorLoadDelay:100,forceFitColumns:!1,enableAsyncPostRender:!1,asyncPostRenderDelay:50,enableAsyncPostRenderCleanup:!1,asyncPostRenderCleanupDelay:40,auto:!1,nonce:"",editorLock:n,showColumnHeader:!0,showHeaderRow:!1,headerRowHeight:25,createFooterRow:!1,showFooterRow:!1,footerRowHeight:25,createPreHeaderPanel:!1,createTopHeaderPanel:!1,showPreHeaderPanel:!1,showTopHeaderPanel:!1,preHeaderPanelHeight:25,showTopPanel:!1,topPanelHeight:25,preHeaderPanelWidth:"auto",topHeaderPanelHeight:25,topHeaderPanelWidth:"auto",formatterFactory:null,editorFactory:null,cellFlashingCssClass:"flashing",rowHighlightCssClass:"highlight-animate",rowHighlightDuration:400,selectedCellCssClass:"selected",multiSelect:!0,enableCellRowSpan:!1,enableTextSelectionOnCells:!1,dataItemColumnValueExtractor:null,frozenBottom:!1,frozenColumn:-1,frozenRow:-1,frozenRightViewportMinWidth:100,throwWhenFrozenNotAllViewable:!1,fullWidthRows:!1,multiColumnSort:!1,numberedMultiColumnSort:!1,tristateMultiColumnSort:!1,sortColNumberInSeparateSpan:!1,defaultFormatter:this.defaultFormatter,forceSyncScrolling:!1,addNewRowCssClass:"new-row",preserveCopiedSelectionOnPaste:!1,preventDragFromKeys:["ctrlKey","metaKey"],showCellSelection:!0,viewportClass:void 0,minRowBuffer:3,emulatePagingWhenScrolling:!0,editorCellNavOnLRKeys:!1,enableMouseWheelScrollHandler:!0,doPaging:!0,autosizeColsMode:r.LegacyOff,autosizeColPaddingPx:4,rowTopOffsetRenderType:"top",scrollRenderThrottling:10,autosizeTextAvgToMWidthRatio:.75,viewportSwitchToScrollModeWidthPercent:void 0,viewportMinWidthPx:void 0,viewportMaxWidthPx:void 0,suppressCssChangesOnHiddenInit:!1,ffMaxSupportedCssHeight:6e6,maxSupportedCssHeight:1e9,maxPartialRowSpanRemap:5e3,sanitizer:void 0,logSanitizedHtml:!1,mixinDefaults:!0,shadowRoot:void 0}),t(this,"_columnDefaults",{name:"",headerCssClass:null,defaultSortAsc:!0,focusable:!0,hidden:!1,minWidth:30,maxWidth:void 0,rerenderOnResize:!1,reorderable:!0,resizable:!0,sortable:!1,selectable:!0}),t(this,"_columnAutosizeDefaults",{ignoreHeaderText:!1,colValueArray:void 0,allowAddlPercent:void 0,formatterOverride:void 0,autosizeMode:o.ContentIntelligent,rowSelectionModeOnInit:void 0,rowSelectionMode:c.FirstNRows,rowSelectionCount:100,valueFilterMode:p.None,widthEvalMode:g.Auto,sizeToRemaining:void 0,widthPx:void 0,contentSizePx:0,headerWidthPx:0,colDataTypeOf:void 0}),t(this,"_columnResizeTimer"),t(this,"_executionBlockTimer"),t(this,"_flashCellTimer"),t(this,"_highlightRowTimer"),t(this,"th"),t(this,"h"),t(this,"ph"),t(this,"n"),t(this,"cj"),t(this,"page",0),t(this,"offset",0),t(this,"vScrollDir",1),t(this,"_bindingEventService",new i),t(this,"initialized",!1),t(this,"_container"),t(this,"uid",`slickgrid_${Math.round(1e6*Math.random())}`),t(this,"dragReplaceEl",new _(this.uid)),t(this,"_focusSink"),t(this,"_focusSink2"),t(this,"_groupHeaders",[]),t(this,"_headerScroller",[]),t(this,"_headers",[]),t(this,"_headerRows"),t(this,"_headerRowScroller"),t(this,"_headerRowSpacerL"),t(this,"_headerRowSpacerR"),t(this,"_footerRow"),t(this,"_footerRowScroller"),t(this,"_footerRowSpacerL"),t(this,"_footerRowSpacerR"),t(this,"_preHeaderPanel"),t(this,"_preHeaderPanelScroller"),t(this,"_preHeaderPanelSpacer"),t(this,"_preHeaderPanelR"),t(this,"_preHeaderPanelScrollerR"),t(this,"_preHeaderPanelSpacerR"),t(this,"_topHeaderPanel"),t(this,"_topHeaderPanelScroller"),t(this,"_topHeaderPanelSpacer"),t(this,"_topPanelScrollers"),t(this,"_topPanels"),t(this,"_viewport"),t(this,"_canvas"),t(this,"_style"),t(this,"_boundAncestors",[]),t(this,"stylesheet"),t(this,"columnCssRulesL"),t(this,"columnCssRulesR"),t(this,"viewportH",0),t(this,"viewportW",0),t(this,"canvasWidth",0),t(this,"canvasWidthL",0),t(this,"canvasWidthR",0),t(this,"headersWidth",0),t(this,"headersWidthL",0),t(this,"headersWidthR",0),t(this,"viewportHasHScroll",!1),t(this,"viewportHasVScroll",!1),t(this,"headerColumnWidthDiff",0),t(this,"headerColumnHeightDiff",0),t(this,"cellWidthDiff",0),t(this,"cellHeightDiff",0),t(this,"absoluteColumnMinWidth"),t(this,"hasFrozenRows",!1),t(this,"frozenRowsHeight",0),t(this,"actualFrozenRow",-1),t(this,"_prevFrozenColumnIdx",-1),t(this,"_invalidfrozenAlerted",!1),t(this,"paneTopH",0),t(this,"paneBottomH",0),t(this,"viewportTopH",0),t(this,"viewportBottomH",0),t(this,"topPanelH",0),t(this,"headerRowH",0),t(this,"footerRowH",0),t(this,"tabbingDirection",1),t(this,"_activeCanvasNode"),t(this,"_activeViewportNode"),t(this,"activePosX"),t(this,"activePosY"),t(this,"activeRow"),t(this,"activeCell"),t(this,"selectionBottomRow"),t(this,"selectionRightCell"),t(this,"activeCellNode",null),t(this,"currentEditor",null),t(this,"serializedEditorValue"),t(this,"editController"),t(this,"_prevDataLength",0),t(this,"_prevInvalidatedRowsCount",0),t(this,"_rowSpanIsCached",!1),t(this,"_colsWithRowSpanCache",{}),t(this,"rowsCache",{}),t(this,"renderedRows",0),t(this,"numVisibleRows",0),t(this,"prevScrollTop",0),t(this,"scrollHeight",0),t(this,"scrollTop",0),t(this,"lastRenderedScrollTop",0),t(this,"lastRenderedScrollLeft",0),t(this,"prevScrollLeft",0),t(this,"scrollLeft",0),t(this,"selectionModel"),t(this,"selectedRows",[]),t(this,"selectedRanges",[]),t(this,"plugins",[]),t(this,"cellCssClasses",{}),t(this,"columnsById",{}),t(this,"sortColumns",[]),t(this,"columnPosLeft",[]),t(this,"columnPosRight",[]),t(this,"pagingActive",!1),t(this,"pagingIsLastPage",!1),t(this,"scrollThrottle"),t(this,"h_editorLoader"),t(this,"h_postrender"),t(this,"h_postrenderCleanup"),t(this,"postProcessedRows",{}),t(this,"postProcessToRow",null),t(this,"postProcessFromRow",null),t(this,"postProcessedCleanupQueue",[]),t(this,"postProcessgroupId",0),t(this,"counter_rows_rendered",0),t(this,"counter_rows_removed",0),t(this,"_paneHeaderL"),t(this,"_paneHeaderR"),t(this,"_paneTopL"),t(this,"_paneTopR"),t(this,"_paneBottomL"),t(this,"_paneBottomR"),t(this,"_headerScrollerL"),t(this,"_headerScrollerR"),t(this,"_headerL"),t(this,"_headerR"),t(this,"_groupHeadersL"),t(this,"_groupHeadersR"),t(this,"_headerRowScrollerL"),t(this,"_headerRowScrollerR"),t(this,"_footerRowScrollerL"),t(this,"_footerRowScrollerR"),t(this,"_headerRowL"),t(this,"_headerRowR"),t(this,"_footerRowL"),t(this,"_footerRowR"),t(this,"_topPanelScrollerL"),t(this,"_topPanelScrollerR"),t(this,"_topPanelL"),t(this,"_topPanelR"),t(this,"_viewportTopL"),t(this,"_viewportTopR"),t(this,"_viewportBottomL"),t(this,"_viewportBottomR"),t(this,"_canvasTopL"),t(this,"_canvasTopR"),t(this,"_canvasBottomL"),t(this,"_canvasBottomR"),t(this,"_viewportScrollContainerX"),t(this,"_viewportScrollContainerY"),t(this,"_headerScrollContainer"),t(this,"_headerRowScrollContainer"),t(this,"_footerRowScrollContainer"),t(this,"cssShow",{position:"absolute",visibility:"hidden",display:"block"}),t(this,"_hiddenParents",[]),t(this,"oldProps",[]),t(this,"enforceFrozenRowHeightRecalc",!1),t(this,"columnResizeDragging",!1),t(this,"slickDraggableInstance",null),t(this,"slickMouseWheelInstances",[]),t(this,"slickResizableInstances",[]),t(this,"sortableSideLeftInstance"),t(this,"sortableSideRightInstance"),t(this,"logMessageCount",0),t(this,"logMessageMaxCount",30),t(this,"_pubSubService"),this._container="string"==typeof this.container?document.querySelector(this.container):this.container,!this._container)throw new Error(`SlickGrid requires a valid container, ${this.container} does not exist in the DOM.`);this._pubSubService=d,this.onActiveCellChanged=new s("onActiveCellChanged",d),this.onActiveCellPositionChanged=new s("onActiveCellPositionChanged",d),this.onAddNewRow=new s("onAddNewRow",d),this.onAfterSetColumns=new s("onAfterSetColumns",d),this.onAutosizeColumns=new s("onAutosizeColumns",d),this.onBeforeAppendCell=new s("onBeforeAppendCell",d),this.onBeforeCellEditorDestroy=new s("onBeforeCellEditorDestroy",d),this.onBeforeColumnsResize=new s("onBeforeColumnsResize",d),this.onBeforeDestroy=new s("onBeforeDestroy",d),this.onBeforeEditCell=new s("onBeforeEditCell",d),this.onBeforeFooterRowCellDestroy=new s("onBeforeFooterRowCellDestroy",d),this.onBeforeHeaderCellDestroy=new s("onBeforeHeaderCellDestroy",d),this.onBeforeHeaderRowCellDestroy=new s("onBeforeHeaderRowCellDestroy",d),this.onBeforeRemoveCachedRow=new s("onRowRemovedFromCache",d),this.onBeforeSetColumns=new s("onBeforeSetColumns",d),this.onBeforeSort=new s("onBeforeSort",d),this.onBeforeUpdateColumns=new s("onBeforeUpdateColumns",d),this.onCellChange=new s("onCellChange",d),this.onCellCssStylesChanged=new s("onCellCssStylesChanged",d),this.onClick=new s("onClick",d),this.onColumnsReordered=new s("onColumnsReordered",d),this.onColumnsDrag=new s("onColumnsDrag",d),this.onColumnsResized=new s("onColumnsResized",d),this.onColumnsResizeDblClick=new s("onColumnsResizeDblClick",d),this.onCompositeEditorChange=new s("onCompositeEditorChange",d),this.onContextMenu=new s("onContextMenu",d),this.onDrag=new s("onDrag",d),this.onDblClick=new s("onDblClick",d),this.onDragInit=new s("onDragInit",d),this.onDragStart=new s("onDragStart",d),this.onDragEnd=new s("onDragEnd",d),this.onFooterClick=new s("onFooterClick",d),this.onFooterContextMenu=new s("onFooterContextMenu",d),this.onFooterRowCellRendered=new s("onFooterRowCellRendered",d),this.onHeaderCellRendered=new s("onHeaderCellRendered",d),this.onHeaderClick=new s("onHeaderClick",d),this.onHeaderContextMenu=new s("onHeaderContextMenu",d),this.onHeaderMouseEnter=new s("onHeaderMouseEnter",d),this.onHeaderMouseLeave=new s("onHeaderMouseLeave",d),this.onHeaderRowCellRendered=new s("onHeaderRowCellRendered",d),this.onHeaderRowMouseEnter=new s("onHeaderRowMouseEnter",d),this.onHeaderRowMouseLeave=new s("onHeaderRowMouseLeave",d),this.onPreHeaderClick=new s("onPreHeaderClick",d),this.onPreHeaderContextMenu=new s("onPreHeaderContextMenu",d),this.onKeyDown=new s("onKeyDown",d),this.onMouseEnter=new s("onMouseEnter",d),this.onMouseLeave=new s("onMouseLeave",d),this.onRendered=new s("onRendered",d),this.onScroll=new s("onScroll",d),this.onSelectedRowsChanged=new s("onSelectedRowsChanged",d),this.onSetOptions=new s("onSetOptions",d),this.onActivateChangedOptions=new s("onActivateChangedOptions",d),this.onSort=new s("onSort",d),this.onValidationError=new s("onValidationError",d),this.onViewportChanged=new s("onViewportChanged",d),this.onDragReplaceCells=new s("onDragReplaceCells",d),this.initialize(a)}init(){this.finishInitialization()}initialize(e){if(null!=e&&e.mixinDefaults?(this._options||(this._options=e),m.applyDefaults(this._options,this._defaults)):this._options=m.extend(!0,{},this._defaults,e),this.scrollThrottle=this.actionThrottle(this.render.bind(this),this._options.scrollRenderThrottling),this.maxSupportedCssHeight=this.maxSupportedCssHeight||this.getMaxSupportedCssHeight(),this.validateAndEnforceOptions(),this._columnDefaults.width=this._options.defaultColumnWidth,this._prevFrozenColumnIdx=this.getFrozenColumnIdx(),this._options.suppressCssChangesOnHiddenInit||this.cacheCssForHiddenInit(),this.updateColumnProps(),this._options.enableColumnReorder&&(!Sortable||!Sortable.create))throw new Error("SlickGrid requires Sortable.js module to be loaded");this.editController={commitCurrentEdit:this.commitCurrentEdit.bind(this),cancelCurrentEdit:this.cancelCurrentEdit.bind(this)},m.emptyElement(this._container),this._container.style.outline=String(0),this._container.classList.add(this.uid),this._container.classList.add("ui-widget"),this._container.setAttribute("role","grid");let t=window.getComputedStyle(this._container);/relative|absolute|fixed/.test(t.position)||(this._container.style.position="relative"),this._focusSink=m.createDomElement("div",{tabIndex:0,style:{position:"fixed",width:"0px",height:"0px",top:"0px",left:"0px",outline:"0px"}},this._container),this._options.createTopHeaderPanel&&(this._topHeaderPanelScroller=m.createDomElement("div",{className:"slick-topheader-panel slick-state-default",style:{overflow:"hidden",position:"relative"}},this._container),this._topHeaderPanelScroller.appendChild(document.createElement("div")),this._topHeaderPanel=m.createDomElement("div",null,this._topHeaderPanelScroller),this._topHeaderPanelSpacer=m.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._topHeaderPanelScroller),this._options.showTopHeaderPanel||m.hide(this._topHeaderPanelScroller)),this._paneHeaderL=m.createDomElement("div",{className:"slick-pane slick-pane-header slick-pane-left",tabIndex:0},this._container),this._paneHeaderR=m.createDomElement("div",{className:"slick-pane slick-pane-header slick-pane-right",tabIndex:0},this._container),this._paneTopL=m.createDomElement("div",{className:"slick-pane slick-pane-top slick-pane-left",tabIndex:0},this._container),this._paneTopR=m.createDomElement("div",{className:"slick-pane slick-pane-top slick-pane-right",tabIndex:0},this._container),this._paneBottomL=m.createDomElement("div",{className:"slick-pane slick-pane-bottom slick-pane-left",tabIndex:0},this._container),this._paneBottomR=m.createDomElement("div",{className:"slick-pane slick-pane-bottom slick-pane-right",tabIndex:0},this._container),this._options.createPreHeaderPanel&&(this._preHeaderPanelScroller=m.createDomElement("div",{className:"slick-preheader-panel ui-state-default slick-state-default",style:{overflow:"hidden",position:"relative"}},this._paneHeaderL),this._preHeaderPanelScroller.appendChild(document.createElement("div")),this._preHeaderPanel=m.createDomElement("div",null,this._preHeaderPanelScroller),this._preHeaderPanelSpacer=m.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._preHeaderPanelScroller),this._preHeaderPanelScrollerR=m.createDomElement("div",{className:"slick-preheader-panel ui-state-default slick-state-default",style:{overflow:"hidden",position:"relative"}},this._paneHeaderR),this._preHeaderPanelR=m.createDomElement("div",null,this._preHeaderPanelScrollerR),this._preHeaderPanelSpacerR=m.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._preHeaderPanelScrollerR),this._options.showPreHeaderPanel||(m.hide(this._preHeaderPanelScroller),m.hide(this._preHeaderPanelScrollerR))),this._headerScrollerL=m.createDomElement("div",{className:"slick-header ui-state-default slick-state-default slick-header-left"},this._paneHeaderL),this._headerScrollerR=m.createDomElement("div",{className:"slick-header ui-state-default slick-state-default slick-header-right"},this._paneHeaderR),this._headerScroller.push(this._headerScrollerL),this._headerScroller.push(this._headerScrollerR),this._headerL=m.createDomElement("div",{className:"slick-header-columns slick-header-columns-left",role:"row",style:{left:"-1000px"}},this._headerScrollerL),this._headerR=m.createDomElement("div",{className:"slick-header-columns slick-header-columns-right",role:"row",style:{left:"-1000px"}},this._headerScrollerR),this._headers=[this._headerL,this._headerR],this._headerRowScrollerL=m.createDomElement("div",{className:"slick-headerrow ui-state-default slick-state-default"},this._paneTopL),this._headerRowScrollerR=m.createDomElement("div",{className:"slick-headerrow ui-state-default slick-state-default"},this._paneTopR),this._headerRowScroller=[this._headerRowScrollerL,this._headerRowScrollerR],this._headerRowSpacerL=m.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._headerRowScrollerL),this._headerRowSpacerR=m.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._headerRowScrollerR),this._headerRowL=m.createDomElement("div",{className:"slick-headerrow-columns slick-headerrow-columns-left"},this._headerRowScrollerL),this._headerRowR=m.createDomElement("div",{className:"slick-headerrow-columns slick-headerrow-columns-right"},this._headerRowScrollerR),this._headerRows=[this._headerRowL,this._headerRowR],this._topPanelScrollerL=m.createDomElement("div",{className:"slick-top-panel-scroller ui-state-default slick-state-default"},this._paneTopL),this._topPanelScrollerR=m.createDomElement("div",{className:"slick-top-panel-scroller ui-state-default slick-state-default"},this._paneTopR),this._topPanelScrollers=[this._topPanelScrollerL,this._topPanelScrollerR],this._topPanelL=m.createDomElement("div",{className:"slick-top-panel",style:{width:"10000px"}},this._topPanelScrollerL),this._topPanelR=m.createDomElement("div",{className:"slick-top-panel",style:{width:"10000px"}},this._topPanelScrollerR),this._topPanels=[this._topPanelL,this._topPanelR],this._options.showColumnHeader||this._headerScroller.forEach((e=>{m.hide(e)})),this._options.showTopPanel||this._topPanelScrollers.forEach((e=>{m.hide(e)})),this._options.showHeaderRow||this._headerRowScroller.forEach((e=>{m.hide(e)})),this._viewportTopL=m.createDomElement("div",{className:"slick-viewport slick-viewport-top slick-viewport-left",tabIndex:0},this._paneTopL),this._viewportTopR=m.createDomElement("div",{className:"slick-viewport slick-viewport-top slick-viewport-right",tabIndex:0},this._paneTopR),this._viewportBottomL=m.createDomElement("div",{className:"slick-viewport slick-viewport-bottom slick-viewport-left",tabIndex:0},this._paneBottomL),this._viewportBottomR=m.createDomElement("div",{className:"slick-viewport slick-viewport-bottom slick-viewport-right",tabIndex:0},this._paneBottomR),this._viewport=[this._viewportTopL,this._viewportTopR,this._viewportBottomL,this._viewportBottomR],this._options.viewportClass&&this._viewport.forEach((e=>{e.classList.add(...m.classNameToList(this._options.viewportClass))})),this._activeViewportNode=this._viewportTopL,this._canvasTopL=m.createDomElement("div",{className:"grid-canvas grid-canvas-top grid-canvas-left",tabIndex:0},this._viewportTopL),this._canvasTopR=m.createDomElement("div",{className:"grid-canvas grid-canvas-top grid-canvas-right",tabIndex:0},this._viewportTopR),this._canvasBottomL=m.createDomElement("div",{className:"grid-canvas grid-canvas-bottom grid-canvas-left",tabIndex:0},this._viewportBottomL),this._canvasBottomR=m.createDomElement("div",{className:"grid-canvas grid-canvas-bottom grid-canvas-right",tabIndex:0},this._viewportBottomR),this._canvas=[this._canvasTopL,this._canvasTopR,this._canvasBottomL,this._canvasBottomR],this.scrollbarDimensions=this.scrollbarDimensions||this.measureScrollbar();let i=this.getCanvasWidth()+this.scrollbarDimensions.width;this._activeCanvasNode=this._canvasTopL,this._topHeaderPanelSpacer&&m.width(this._topHeaderPanelSpacer,i),this._preHeaderPanelSpacer&&m.width(this._preHeaderPanelSpacer,i),this._headers.forEach((e=>{m.width(e,this.getHeadersWidth())})),m.width(this._headerRowSpacerL,i),m.width(this._headerRowSpacerR,i),this._options.createFooterRow&&(this._footerRowScrollerR=m.createDomElement("div",{className:"slick-footerrow ui-state-default slick-state-default"},this._paneTopR),this._footerRowScrollerL=m.createDomElement("div",{className:"slick-footerrow ui-state-default slick-state-default"},this._paneTopL),this._footerRowScroller=[this._footerRowScrollerL,this._footerRowScrollerR],this._footerRowSpacerL=m.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._footerRowScrollerL),m.width(this._footerRowSpacerL,i),this._footerRowSpacerR=m.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._footerRowScrollerR),m.width(this._footerRowSpacerR,i),this._footerRowL=m.createDomElement("div",{className:"slick-footerrow-columns slick-footerrow-columns-left"},this._footerRowScrollerL),this._footerRowR=m.createDomElement("div",{className:"slick-footerrow-columns slick-footerrow-columns-right"},this._footerRowScrollerR),this._footerRow=[this._footerRowL,this._footerRowR],this._options.showFooterRow||this._footerRowScroller.forEach((e=>{m.hide(e)}))),this._focusSink2=this._focusSink.cloneNode(!0),this._container.appendChild(this._focusSink2),this._options.explicitInitialization||this.finishInitialization()}finishInitialization(){this.initialized||(this.initialized=!0,this.getViewportWidth(),this.getViewportHeight(),this.measureCellPaddingAndBorder(),this.disableSelection(this._headers),this._options.enableTextSelectionOnCells||this._viewport.forEach((e=>{this._bindingEventService.bind(e,"selectstart",(e=>{e.target instanceof HTMLInputElement||(e.target,HTMLTextAreaElement)}))})),this.setFrozenOptions(),this.setPaneFrozenClasses(),this.setPaneVisibility(),this.setScroller(),this.setOverflow(),this.updateColumnCaches(),this.createColumnHeaders(),this.createColumnFooter(),this.setupColumnSort(),this.createCssRules(),this.resizeCanvas(),this.bindAncestorScrollEvents(),this._bindingEventService.bind(this._container,"resize",this.resizeCanvas.bind(this)),this._viewport.forEach((e=>{this._bindingEventService.bind(e,"scroll",this.handleScroll.bind(this))})),this._options.enableMouseWheelScrollHandler&&this._viewport.forEach((e=>{this.slickMouseWheelInstances.push(C({element:e,onMouseWheel:this.handleMouseWheel.bind(this)}))})),this._headerScroller.forEach((e=>{this._bindingEventService.bind(e,"contextmenu",this.handleHeaderContextMenu.bind(this)),this._bindingEventService.bind(e,"click",this.handleHeaderClick.bind(this))})),this._headerRowScroller.forEach((e=>{this._bindingEventService.bind(e,"scroll",this.handleHeaderRowScroll.bind(this))})),this._options.createFooterRow&&(this._footerRow.forEach((e=>{this._bindingEventService.bind(e,"contextmenu",this.handleFooterContextMenu.bind(this)),this._bindingEventService.bind(e,"click",this.handleFooterClick.bind(this))})),this._footerRowScroller.forEach((e=>{this._bindingEventService.bind(e,"scroll",this.handleFooterRowScroll.bind(this))}))),this._options.createTopHeaderPanel&&this._bindingEventService.bind(this._topHeaderPanelScroller,"scroll",this.handleTopHeaderPanelScroll.bind(this)),this._options.createPreHeaderPanel&&(this._bindingEventService.bind(this._preHeaderPanelScroller,"scroll",this.handlePreHeaderPanelScroll.bind(this)),this._bindingEventService.bind(this._preHeaderPanelScroller,"contextmenu",this.handlePreHeaderContextMenu.bind(this)),this._bindingEventService.bind(this._preHeaderPanelScrollerR,"contextmenu",this.handlePreHeaderContextMenu.bind(this)),this._bindingEventService.bind(this._preHeaderPanelScroller,"click",this.handlePreHeaderClick.bind(this)),this._bindingEventService.bind(this._preHeaderPanelScrollerR,"click",this.handlePreHeaderClick.bind(this))),this._bindingEventService.bind(this._focusSink,"keydown",this.handleKeyDown.bind(this)),this._bindingEventService.bind(this._focusSink2,"keydown",this.handleKeyDown.bind(this)),this._canvas.forEach((e=>{this._bindingEventService.bind(e,"keydown",this.handleKeyDown.bind(this)),this._bindingEventService.bind(e,"click",this.handleClick.bind(this)),this._bindingEventService.bind(e,"dblclick",this.handleDblClick.bind(this)),this._bindingEventService.bind(e,"contextmenu",this.handleContextMenu.bind(this)),this._bindingEventService.bind(e,"mouseover",this.handleCellMouseOver.bind(this)),this._bindingEventService.bind(e,"mouseout",this.handleCellMouseOut.bind(this))})),v&&(this.slickDraggableInstance=v({containerElement:this._container,allowDragFrom:"div.slick-cell, div."+this.dragReplaceEl.cssClass,dragFromClassDetectArr:[{tag:"dragReplaceHandle",id:this.dragReplaceEl.id}],allowDragFromClosest:"div.slick-cell.dnd, div.slick-cell.cell-reorder",preventDragFromKeys:this._options.preventDragFromKeys,onDragInit:this.handleDragInit.bind(this),onDragStart:this.handleDragStart.bind(this),onDrag:this.handleDrag.bind(this),onDragEnd:this.handleDragEnd.bind(this)})),this._options.suppressCssChangesOnHiddenInit||this.restoreCssFromHiddenInit())}cacheCssForHiddenInit(){this._hiddenParents=m.parents(this._container,":hidden"),this.oldProps=[],this._hiddenParents.forEach((e=>{let t={};Object.keys(this.cssShow).forEach((i=>{this.cssShow&&(t[i]=e.style[i],e.style[i]=this.cssShow[i])})),this.oldProps.push(t)}))}restoreCssFromHiddenInit(){let e=0;this._hiddenParents&&(this._hiddenParents.forEach((t=>{let i=this.oldProps[e++];Object.keys(this.cssShow).forEach((e=>{this.cssShow&&(t.style[e]=i[e])}))})),this._hiddenParents=[])}registerPlugin(e){this.plugins.unshift(e),e.init(this)}unregisterPlugin(e){var t;for(let i=this.plugins.length;i>=0;i--)if(this.plugins[i]===e){null==(t=this.plugins[i])||t.destroy(),this.plugins.splice(i,1);break}}destroy(e){var t,i,o,s;this._bindingEventService.unbindAll(),this.slickDraggableInstance=this.destroyAllInstances(this.slickDraggableInstance),this.slickMouseWheelInstances=this.destroyAllInstances(this.slickMouseWheelInstances),this.slickResizableInstances=this.destroyAllInstances(this.slickResizableInstances),null==(t=this.getEditorLock())||t.cancelCurrentEdit(),this.trigger(this.onBeforeDestroy,{});let l=this.plugins.length;for(;l--;)this.unregisterPlugin(this.plugins[l]);this._options.enableColumnReorder&&"function"==typeof(null==(i=this.sortableSideLeftInstance)?void 0:i.destroy)&&(null==(o=this.sortableSideLeftInstance)||o.destroy(),null==(s=this.sortableSideRightInstance)||s.destroy()),this.unbindAncestorScrollEvents(),this._bindingEventService.unbindByEventName(this._container,"resize"),this.removeCssRules(),this._canvas.forEach((e=>{this._bindingEventService.unbindByEventName(e,"keydown"),this._bindingEventService.unbindByEventName(e,"click"),this._bindingEventService.unbindByEventName(e,"dblclick"),this._bindingEventService.unbindByEventName(e,"contextmenu"),this._bindingEventService.unbindByEventName(e,"mouseover"),this._bindingEventService.unbindByEventName(e,"mouseout")})),this._viewport.forEach((e=>{this._bindingEventService.unbindByEventName(e,"scroll")})),this._headerScroller.forEach((e=>{this._bindingEventService.unbindByEventName(e,"contextmenu"),this._bindingEventService.unbindByEventName(e,"click")})),this._headerRowScroller.forEach((e=>{this._bindingEventService.unbindByEventName(e,"scroll")})),this._footerRow&&this._footerRow.forEach((e=>{this._bindingEventService.unbindByEventName(e,"contextmenu"),this._bindingEventService.unbindByEventName(e,"click")})),this._footerRowScroller&&this._footerRowScroller.forEach((e=>{this._bindingEventService.unbindByEventName(e,"scroll")})),this._preHeaderPanelScroller&&this._bindingEventService.unbindByEventName(this._preHeaderPanelScroller,"scroll"),this._topHeaderPanelScroller&&this._bindingEventService.unbindByEventName(this._topHeaderPanelScroller,"scroll"),this._bindingEventService.unbindByEventName(this._focusSink,"keydown"),this._bindingEventService.unbindByEventName(this._focusSink2,"keydown");let n=this._container.querySelectorAll(".slick-resizable-handle");[].forEach.call(n,(e=>{this._bindingEventService.unbindByEventName(e,"dblclick")}));let r=this._container.querySelectorAll(".slick-header-column");[].forEach.call(r,(e=>{this._bindingEventService.unbindByEventName(e,"mouseenter"),this._bindingEventService.unbindByEventName(e,"mouseleave"),this._bindingEventService.unbindByEventName(e,"mouseenter"),this._bindingEventService.unbindByEventName(e,"mouseleave")})),m.emptyElement(this._container),this._container.classList.remove(this.uid),this.clearAllTimers(),e&&this.destroyAllElements()}destroyAllInstances(e){if(e){let t,i=Array.isArray(e)?e:[e];for(;m.isDefined(t=i.pop());)t&&"function"==typeof t.destroy&&t.destroy()}return e=Array.isArray(e)?[]:null}destroyAllElements(){this._activeCanvasNode=null,this._activeViewportNode=null,this._boundAncestors=null,this._canvas=null,this._canvasTopL=null,this._canvasTopR=null,this._canvasBottomL=null,this._canvasBottomR=null,this._container=null,this._focusSink=null,this._focusSink2=null,this._groupHeaders=null,this._groupHeadersL=null,this._groupHeadersR=null,this._headerL=null,this._headerR=null,this._headers=null,this._headerRows=null,this._headerRowL=null,this._headerRowR=null,this._headerRowSpacerL=null,this._headerRowSpacerR=null,this._headerRowScrollContainer=null,this._headerRowScroller=null,this._headerRowScrollerL=null,this._headerRowScrollerR=null,this._headerScrollContainer=null,this._headerScroller=null,this._headerScrollerL=null,this._headerScrollerR=null,this._hiddenParents=null,this._footerRow=null,this._footerRowL=null,this._footerRowR=null,this._footerRowSpacerL=null,this._footerRowSpacerR=null,this._footerRowScroller=null,this._footerRowScrollerL=null,this._footerRowScrollerR=null,this._footerRowScrollContainer=null,this._preHeaderPanel=null,this._preHeaderPanelR=null,this._preHeaderPanelScroller=null,this._preHeaderPanelScrollerR=null,this._preHeaderPanelSpacer=null,this._preHeaderPanelSpacerR=null,this._topPanels=null,this._topPanelScrollers=null,this._style=null,this._topPanelScrollerL=null,this._topPanelScrollerR=null,this._topPanelL=null,this._topPanelR=null,this._paneHeaderL=null,this._paneHeaderR=null,this._paneTopL=null,this._paneTopR=null,this._paneBottomL=null,this._paneBottomR=null,this._viewport=null,this._viewportTopL=null,this._viewportTopR=null,this._viewportBottomL=null,this._viewportBottomR=null,this._viewportScrollContainerX=null,this._viewportScrollContainerY=null}getOptions(){return this._options}getFrozenColumnId(){let e=this.getFrozenColumnIdx();return e>=0&&this.columns[e]?this.columns[e].id:null}getFrozenColumnIdx(){var e;return null!=(e=this._options.frozenColumn)?e:-1}setOptions(e,t,i,o){this.prepareForOptionsChange(),this._options.enableAddRow!==e.enableAddRow&&this.invalidateRow(this.getDataLength()),void 0!==e.frozenColumn&&e.frozenColumn>=0&&(this._prevFrozenColumnIdx=this.getFrozenColumnIdx(),i||(this._invalidfrozenAlerted=!1),this.validateColumnFreezeWidth(e.frozenColumn)?(this.getViewports().forEach((e=>e.scrollLeft=0)),this.handleScroll()):e.frozenColumn=this._prevFrozenColumnIdx<e.frozenColumn?this._prevFrozenColumnIdx:-1);let s=m.extend(!0,{},this._options);this._options=m.extend(this._options,e),this.trigger(this.onSetOptions,{optionsBefore:s,optionsAfter:this._options}),this.internal_setOptions(t,i,o)}activateChangedOptions(e,t,i){this.prepareForOptionsChange(),this.invalidateRow(this.getDataLength()),this.trigger(this.onActivateChangedOptions,{options:this._options}),this.internal_setOptions(e,t,i)}prepareForOptionsChange(){this.getEditorLock().commitCurrentEdit()&&this.makeActiveCellNormal()}internal_setOptions(e,t,i){void 0!==this._options.showColumnHeader&&this.setColumnHeaderVisibility(this._options.showColumnHeader),this.validateAndEnforceOptions(),this.setFrozenOptions(),void 0!==this._options.frozenBottom&&(this.enforceFrozenRowHeightRecalc=!0),this._viewport.forEach((e=>{e.style.overflowY=this._options.autoHeight?"hidden":"auto"})),e||this.render(),this.setScroller(),i||this.setOverflow(),t||this.setColumns(this.columns),!this._options.enableMouseWheelScrollHandler||!this._viewport||this.slickMouseWheelInstances&&0!==this.slickMouseWheelInstances.length?!1===this._options.enableMouseWheelScrollHandler&&this.destroyAllInstances(this.slickMouseWheelInstances):this._viewport.forEach((e=>{this.slickMouseWheelInstances.push(C({element:e,onMouseWheel:this.handleMouseWheel.bind(this)}))}))}validateAndEnforceOptions(){this._options.autoHeight&&(this._options.leaveSpaceForNewRows=!1),this._options.forceFitColumns&&(this._options.autosizeColsMode=r.LegacyForceFit),this.validateColumnFreezeWidth(this._options.frozenColumn)||(this._options.frozenColumn=this._prevFrozenColumnIdx<this._options.frozenColumn?this._prevFrozenColumnIdx:-1)}setSelectionModel(e){this.selectionModel&&(this.selectionModel.onSelectedRangesChanged.unsubscribe(this.handleSelectedRangesChanged.bind(this)),this.selectionModel.destroy&&this.selectionModel.destroy()),this.selectionModel=e,this.selectionModel&&(this.selectionModel.init(this),this.selectionModel.onSelectedRangesChanged.subscribe(this.handleSelectedRangesChanged.bind(this)))}getSelectionModel(){return this.selectionModel}setPaneFrozenClasses(){let e=this.hasFrozenColumns()?"add":"remove";for(let t of[this._paneHeaderL,this._paneTopL,this._paneBottomL])t.classList[e]("frozen")}hasFrozenColumns(){return this._options.frozenColumn>-1}updateColumnHeader(e,t,i){if(this.initialized){let o=this.getColumnIndex(e);if(!m.isDefined(o))return;let s=this.columns[o],l=this.getColumnByIndex(o);l&&(void 0!==t&&(this.columns[o].name=t),void 0!==i&&(this.columns[o].toolTip=i),this.trigger(this.onBeforeHeaderCellDestroy,{node:l,column:s,grid:this}),l.setAttribute("title",i||""),void 0!==t&&this.applyHtmlCode(l.children[0],t),this.trigger(this.onHeaderCellRendered,{node:l,column:s,grid:this}))}}getHeader(e){if(!e)return this.hasFrozenColumns()?this._headers:this._headerL;let t=this.getColumnIndex(e.id);return this.hasFrozenColumns()?t<=this._options.frozenColumn?this._headerL:this._headerR:this._headerL}getHeaderColumn(e){let t="number"==typeof e?e:this.getColumnIndex(e),i=this.hasFrozenColumns()?t<=this._options.frozenColumn?this._headerL:this._headerR:this._headerL,o=this.hasFrozenColumns()?t<=this._options.frozenColumn?t:t-this._options.frozenColumn-1:t;return i.children[o]}getHeaderRow(){return this.hasFrozenColumns()?this._headerRows:this._headerRows[0]}getFooterRow(){return this.hasFrozenColumns()?this._footerRow:this._footerRow[0]}getHeaderRowColumn(e){let t,i="number"==typeof e?e:this.getColumnIndex(e);return this.hasFrozenColumns()?i<=this._options.frozenColumn?t=this._headerRowL:(t=this._headerRowR,i-=this._options.frozenColumn+1):t=this._headerRowL,t.children[i]}getFooterRowColumn(e){let t,i="number"==typeof e?e:this.getColumnIndex(e);return this.hasFrozenColumns()?i<=this._options.frozenColumn?t=this._footerRowL:(t=this._footerRowR,i-=this._options.frozenColumn+1):t=this._footerRowL,t.children[i]}createColumnFooter(){if(this._options.createFooterRow){this._footerRow.forEach((e=>{e.querySelectorAll(".slick-footerrow-column").forEach((e=>{let t=m.storage.get(e,"column");this.trigger(this.onBeforeFooterRowCellDestroy,{node:e,column:t,grid:this})}))})),m.emptyElement(this._footerRowL),m.emptyElement(this._footerRowR);for(let e=0;e<this.columns.length;e++){let t=this.columns[e];if(!t||t.hidden)continue;let i=m.createDomElement("div",{className:`ui-state-default slick-state-default slick-footerrow-column l${e} r${e}`},this.hasFrozenColumns()&&e>this._options.frozenColumn?this._footerRowR:this._footerRowL),o=this.hasFrozenColumns()&&e<=this._options.frozenColumn?"frozen":null;o&&i.classList.add(o),m.storage.put(i,"column",t),this.trigger(this.onFooterRowCellRendered,{node:i,column:t,grid:this})}}}setupColumnSort(){this._headers.forEach((e=>{this._bindingEventService.bind(e,"click",(e=>{var t;if(this.columnResizeDragging||e.target.classList.contains("slick-resizable-handle"))return;let i=e.target.closest(".slick-header-column");if(!i)return;let o=m.storage.get(i,"column");if(o.sortable){if(null==(t=this.getEditorLock())||!t.commitCurrentEdit())return;let i=this.sortColumns.slice(),s=null,l=0;for(;l<this.sortColumns.length;l++)if(this.sortColumns[l].columnId===o.id){s=this.sortColumns[l],s.sortAsc=!s.sortAsc;break}let n,r=!!s;this._options.tristateMultiColumnSort?(s||(s={columnId:o.id,sortAsc:o.defaultSortAsc,sortCol:o}),r&&s.sortAsc&&(this.sortColumns.splice(l,1),s=null),this._options.multiColumnSort||(this.sortColumns=[]),s&&(!r||!this._options.multiColumnSort)&&this.sortColumns.push(s)):e.metaKey&&this._options.multiColumnSort?s&&this.sortColumns.splice(l,1):((!e.shiftKey&&!e.metaKey||!this._options.multiColumnSort)&&(this.sortColumns=[]),s?0===this.sortColumns.length&&this.sortColumns.push(s):(s={columnId:o.id,sortAsc:o.defaultSortAsc,sortCol:o},this.sortColumns.push(s))),n=this._options.multiColumnSort?{multiColumnSort:!0,previousSortColumns:i,sortCols:this.sortColumns.map((e=>{let t=this.columns[this.getColumnIndex(e.columnId)];return!t||t.hidden?null:{columnId:t.id,sortCol:t,sortAsc:e.sortAsc}})).filter((e=>e))}:{multiColumnSort:!1,previousSortColumns:i,columnId:this.sortColumns.length>0?o.id:null,sortCol:this.sortColumns.length>0?o:null,sortAsc:!(this.sortColumns.length>0)||this.sortColumns[0].sortAsc},!1!==this.trigger(this.onBeforeSort,n,e).getReturnValue()&&(this.setSortColumns(this.sortColumns),this.trigger(this.onSort,n,e))}}))}))}createColumnHeaders(){this._headers.forEach((e=>{e.querySelectorAll(".slick-header-column").forEach((e=>{let t=m.storage.get(e,"column");t&&this.trigger(this.onBeforeHeaderCellDestroy,{node:e,column:t,grid:this})}))})),m.emptyElement(this._headerL),m.emptyElement(this._headerR),this.getHeadersWidth(),m.width(this._headerL,this.headersWidthL),m.width(this._headerR,this.headersWidthR),this._headerRows.forEach((e=>{e.querySelectorAll(".slick-headerrow-column").forEach((e=>{let t=m.storage.get(e,"column");t&&this.trigger(this.onBeforeHeaderRowCellDestroy,{node:this,column:t,grid:this})}))})),m.emptyElement(this._headerRowL),m.emptyElement(this._headerRowR),this._options.createFooterRow&&(this._footerRowL.querySelectorAll(".slick-footerrow-column").forEach((e=>{let t=m.storage.get(e,"column");t&&this.trigger(this.onBeforeFooterRowCellDestroy,{node:this,column:t,grid:this})})),m.emptyElement(this._footerRowL),this.hasFrozenColumns()&&(this._footerRowR.querySelectorAll(".slick-footerrow-column").forEach((e=>{let t=m.storage.get(e,"column");t&&this.trigger(this.onBeforeFooterRowCellDestroy,{node:this,column:t,grid:this})})),m.emptyElement(this._footerRowR)));for(let e=0;e<this.columns.length;e++){let t=this.columns[e];if(t.hidden)continue;let i=this.hasFrozenColumns()?e<=this._options.frozenColumn?this._headerL:this._headerR:this._headerL,o=this.hasFrozenColumns()?e<=this._options.frozenColumn?this._headerRowL:this._headerRowR:this._headerRowL,s=m.createDomElement("div",{id:`${this.uid+t.id}`,dataset:{id:String(t.id)},role:"columnheader",className:"ui-state-default slick-state-default slick-header-column"},i);t.toolTip&&(s.title=t.toolTip),t.reorderable||s.classList.add(this._options.unorderableColumnCssClass);let l=m.createDomElement("span",{className:"slick-column-name"},s);this.applyHtmlCode(l,t.name),m.width(s,t.width-this.headerColumnWidthDiff);let n=t.headerCssClass||null;if(n&&s.classList.add(...m.classNameToList(n)),n=this.hasFrozenColumns()&&e<=this._options.frozenColumn?"frozen":null,n&&s.classList.add(n),this._bindingEventService.bind(s,"mouseenter",this.handleHeaderMouseEnter.bind(this)),this._bindingEventService.bind(s,"mouseleave",this.handleHeaderMouseLeave.bind(this)),m.storage.put(s,"column",t),(this._options.enableColumnReorder||t.sortable)&&(this._bindingEventService.bind(s,"mouseenter",this.handleHeaderMouseHoverOn.bind(this)),this._bindingEventService.bind(s,"mouseleave",this.handleHeaderMouseHoverOff.bind(this))),t.hasOwnProperty("headerCellAttrs")&&t.headerCellAttrs instanceof Object&&Object.keys(t.headerCellAttrs).forEach((e=>{t.headerCellAttrs.hasOwnProperty(e)&&s.setAttribute(e,t.headerCellAttrs[e])})),t.sortable&&(s.classList.add("slick-header-sortable"),m.createDomElement("div",{className:"slick-sort-indicator "+(this._options.numberedMultiColumnSort&&!this._options.sortColNumberInSeparateSpan?" slick-sort-indicator-numbered":"")},s),this._options.numberedMultiColumnSort&&this._options.sortColNumberInSeparateSpan&&m.createDomElement("div",{className:"slick-sort-indicator-numbered"},s)),this.trigger(this.onHeaderCellRendered,{node:s,column:t,grid:this}),this._options.showHeaderRow){let i=m.createDomElement("div",{className:`ui-state-default slick-state-default slick-headerrow-column l${e} r${e}`},o),s=this.hasFrozenColumns()&&e<=this._options.frozenColumn?"frozen":null;s&&i.classList.add(s),this._bindingEventService.bind(i,"mouseenter",this.handleHeaderRowMouseEnter.bind(this)),this._bindingEventService.bind(i,"mouseleave",this.handleHeaderRowMouseLeave.bind(this)),m.storage.put(i,"column",t),this.trigger(this.onHeaderRowCellRendered,{node:i,column:t,grid:this})}if(this._options.createFooterRow&&this._options.showFooterRow){let i=this.hasFrozenColumns()?e<=this._options.frozenColumn?this._footerRow[0]:this._footerRow[1]:this._footerRow[0],o=m.createDomElement("div",{className:`ui-state-default slick-state-default slick-footerrow-column l${e} r${e}`},i);m.storage.put(o,"column",t),this.trigger(this.onFooterRowCellRendered,{node:o,column:t,grid:this})}}this.setSortColumns(this.sortColumns),this.setupColumnResize(),this._options.enableColumnReorder&&("function"==typeof this._options.enableColumnReorder?this._options.enableColumnReorder(this,this._headers,this.headerColumnWidthDiff,this.setColumns,this.setupColumnResize,this.columns,this.getColumnIndex,this.uid,this.trigger):this.setupColumnReorder())}setupColumnReorder(){var e,t;null==(e=this.sortableSideLeftInstance)||e.destroy(),null==(t=this.sortableSideRightInstance)||t.destroy();let i=null,o=()=>this._viewportScrollContainerX.scrollLeft=this._viewportScrollContainerX.scrollLeft+10,s=()=>this._viewportScrollContainerX.scrollLeft=this._viewportScrollContainerX.scrollLeft-10,l=[],n=!1,r={animation:50,direction:"horizontal",chosenClass:"slick-header-column-active",ghostClass:"slick-sortable-placeholder",draggable:".slick-header-column",dragoverBubble:!1,revertClone:!0,scroll:!this.hasFrozenColumns(),filter:`.${this._options.unorderableColumnCssClass}`,onMove:e=>!e.related.classList.contains(this._options.unorderableColumnCssClass),onStart:e=>{e.item.classList.add("slick-header-column-active"),n=!this.hasFrozenColumns()||m.offset(e.item).left>m.offset(this._viewportScrollContainerX).left,n&&e.originalEvent.pageX>this._container.clientWidth?i||(i=window.setInterval(o,100)):n&&e.originalEvent.pageX<m.offset(this._viewportScrollContainerX).left?i||(i=window.setInterval(s,100)):(window.clearInterval(i),i=null),l=this.columns.map((e=>e.id))},onEnd:e=>{var t,o,s,n,r;e.item.classList.remove("slick-header-column-active"),clearInterval(i);let h=this.scrollLeft;if(null==(t=this.getEditorLock())||!t.commitCurrentEdit())return;let a=null!=(s=null==(o=this.sortableSideLeftInstance)?void 0:o.toArray())?s:[];a=a.concat(null!=(r=null==(n=this.sortableSideRightInstance)?void 0:n.toArray())?r:[]);let d=[];for(let e=0;e<a.length;e++)d.push(this.columns[this.getColumnIndex(a[e])]);e.stopPropagation(),this.arrayEquals(l,a)||(this.setColumns(d),this.scrollToX(h),this.trigger(this.onColumnsReordered,{impactedColumns:this.columns,previousColumnOrder:l}),this.setupColumnResize()),this.activeCellNode&&this.setFocus()}};this.sortableSideLeftInstance=Sortable.create(this._headerL,r),this.sortableSideRightInstance=Sortable.create(this._headerR,r)}getHeaderChildren(){let e=Array.from(this._headers[0].children),t=Array.from(this._headers[1].children);return e.concat(t)}handleResizeableDoubleClick(e){let t=e.target.parentElement.id.replace(this.uid,"");this.trigger(this.onColumnsResizeDblClick,{triggeredByColumn:t})}setupColumnResize(){if(void 0===f)throw new Error('Slick.Resizable is undefined, make sure to import "slick.interactions.js"');let e,t,i,o,s,l,n,r=-1,h=0,a=this.getHeaderChildren(),d=this.getVisibleColumns();for(let e=0;e<a.length;e++)a[e].querySelectorAll(".slick-resizable-handle").forEach((e=>e.remove())),!(e>=d.length)&&d[e]&&d[e].resizable&&(void 0===n&&(n=e),r=e);if(void 0!==n)for(let c=0;c<a.length;c++){let u=a[c];if(c>=d.length||!d[c]||c<n||this._options.forceFitColumns&&c>=r)continue;let p=m.createDomElement("div",{className:"slick-resizable-handle",role:"separator",ariaOrientation:"horizontal"},u);this._bindingEventService.bind(p,"dblclick",this.handleResizeableDoubleClick.bind(this)),this.slickResizableInstances.push(f({resizeableElement:u,resizeableHandleElement:p,onResizeStart:(t,n)=>{var r;let u=t.touches?t.changedTouches[0]:t;if(null==(r=this.getEditorLock())||!r.commitCurrentEdit())return!1;o=u.pageX,h=0,n.resizeableElement.classList.add("slick-header-column-active");let p=null,m=null;for(let e=0;e<a.length;e++)e>=d.length||!d[e]||(d[e].previousWidth=a[e].offsetWidth);if(this._options.forceFitColumns)for(p=0,m=0,e=c+1;e<d.length;e++)i=d[e],null!=i&&i.resizable&&(null!==m&&(i.maxWidth?m+=i.maxWidth-(i.previousWidth||0):m=null),p+=(i.previousWidth||0)-Math.max(i.minWidth||0,this.absoluteColumnMinWidth));let w=0,g=0;for(e=0;e<=c;e++)i=d[e],null!=i&&i.resizable&&(null!==g&&(i.maxWidth?g+=i.maxWidth-(i.previousWidth||0):g=null),w+=(i.previousWidth||0)-Math.max(i.minWidth||0,this.absoluteColumnMinWidth));null===p&&(p=1e5),null===w&&(w=1e5),null===m&&(m=1e5),null===g&&(g=1e5),l=o+Math.min(p,g),s=o-Math.min(w,m)},onResize:(n,r)=>{let a=n.touches?n.changedTouches[0]:n;this.columnResizeDragging=!0;let u,p,w=Math.min(l,Math.max(s,a.pageX))-o,g=0,v=0,C=this.getViewportInnerWidth();if(w<0){for(p=w,e=c;e>=0;e--)i=d[e],null!=i&&i.resizable&&!i.hidden&&(u=Math.max(i.minWidth||0,this.absoluteColumnMinWidth),p&&(i.previousWidth||0)+p<u?(p+=(i.previousWidth||0)-u,i.width=u):(i.width=(i.previousWidth||0)+p,p=0));for(t=0;t<=c;t++)i=d[t],i&&!i.hidden&&(this.hasFrozenColumns()&&t>this._options.frozenColumn?v+=i.width||0:g+=i.width||0);if(this._options.forceFitColumns)for(p=-w,e=c+1;e<d.length;e++)i=d[e],i&&!i.hidden&&i.resizable&&(p&&i.maxWidth&&i.maxWidth-(i.previousWidth||0)<p?(p-=i.maxWidth-(i.previousWidth||0),i.width=i.maxWidth):(i.width=(i.previousWidth||0)+p,p=0),this.hasFrozenColumns()&&e>this._options.frozenColumn?v+=i.width||0:g+=i.width||0);else for(e=c+1;e<d.length;e++)i=d[e],i&&!i.hidden&&(this.hasFrozenColumns()&&e>this._options.frozenColumn?v+=i.width||0:g+=i.width||0);if(this._options.forceFitColumns)for(p=-w,e=c+1;e<d.length;e++)i=d[e],i&&!i.hidden&&i.resizable&&(p&&i.maxWidth&&i.maxWidth-(i.previousWidth||0)<p?(p-=i.maxWidth-(i.previousWidth||0),i.width=i.maxWidth):(i.width=(i.previousWidth||0)+p,p=0))}else{for(p=w,g=0,v=0,e=c;e>=0;e--)if(i=d[e],i&&!i.hidden&&i.resizable)if(p&&i.maxWidth&&i.maxWidth-(i.previousWidth||0)<p)p-=i.maxWidth-(i.previousWidth||0),i.width=i.maxWidth;else{let t=(i.previousWidth||0)+p,o=this.canvasWidthL+p;this.hasFrozenColumns()&&e<=this._options.frozenColumn?(t>h&&o<C-this._options.frozenRightViewportMinWidth&&(h=t),i.width=o+this._options.frozenRightViewportMinWidth>C?h:t):i.width=t,p=0}for(t=0;t<=c;t++)i=d[t],i&&!i.hidden&&(this.hasFrozenColumns()&&t>this._options.frozenColumn?v+=i.width||0:g+=i.width||0);if(this._options.forceFitColumns)for(p=-w,e=c+1;e<d.length;e++)i=d[e],i&&!i.hidden&&i.resizable&&(u=Math.max(i.minWidth||0,this.absoluteColumnMinWidth),p&&(i.previousWidth||0)+p<u?(p+=(i.previousWidth||0)-u,i.width=u):(i.width=(i.previousWidth||0)+p,p=0),this.hasFrozenColumns()&&e>this._options.frozenColumn?v+=i.width||0:g+=i.width||0);else for(e=c+1;e<d.length;e++)i=d[e],i&&!i.hidden&&(this.hasFrozenColumns()&&e>this._options.frozenColumn?v+=i.width||0:g+=i.width||0)}this.hasFrozenColumns()&&g!==this.canvasWidthL&&(m.width(this._headerL,g+1e3),m.setStyleSize(this._paneHeaderR,"left",g)),this.applyColumnHeaderWidths(),this._options.syncColumnCellResize&&this.applyColumnWidths(),this.trigger(this.onColumnsDrag,{triggeredByColumn:r.resizeableElement,resizeHandle:r.resizeableHandleElement})},onResizeEnd:(t,o)=>{o.resizeableElement.classList.remove("slick-header-column-active");let s,l=o.resizeableElement.id.replace(this.uid,"");for(!0===this.trigger(this.onBeforeColumnsResize,{triggeredByColumn:l}).getReturnValue()&&this.applyColumnHeaderWidths(),e=0;e<d.length;e++)i=d[e],i&&!i.hidden&&(s=a[e].offsetWidth,i.previousWidth!==s&&i.rerenderOnResize&&this.invalidateAllRows());this.updateCanvasWidth(!0),this.render(),this.trigger(this.onColumnsResized,{triggeredByColumn:l}),window.clearTimeout(this._columnResizeTimer),this._columnResizeTimer=window.setTimeout((()=>{this.columnResizeDragging=!1}),300)}}))}}setFrozenOptions(){if(this._options.frozenColumn=this._options.frozenColumn>=0&&this._options.frozenColumn<this.columns.length?parseInt(this._options.frozenColumn,10):-1,this._options.frozenRow>-1){this.hasFrozenRows=!0,this.frozenRowsHeight=this._options.frozenRow*this._options.rowHeight;let e=this.getDataLength();this.actualFrozenRow=this._options.frozenBottom?e-this._options.frozenRow:this._options.frozenRow}else this.hasFrozenRows=!1}autosizeColumn(e,t){let i=null,o=-1;if("number"==typeof e)i=this.columns[e],o=e;else if("string"==typeof e)for(let t=0;t<this.columns.length;t++)this.columns[t].id===e&&(i=this.columns[t],o=t);if(!i)return;let s=this.getCanvasNode(0,0);this.getColAutosizeWidth(i,o,s,t||!1,o)}treatAsLocked(e={}){var t;return!e.ignoreHeaderText&&!e.sizeToRemaining&&e.contentSizePx===e.headerWidthPx&&(null!=(t=e.widthPx)?t:0)<100}autosizeColumns(e,t){var i;let o=!(null!=(i=this._hiddenParents)&&i.length);o&&this.cacheCssForHiddenInit(),this.internalAutosizeColumns(e,t),o&&this.restoreCssFromHiddenInit()}internalAutosizeColumns(e,t){var i,s,l,n,h,a,d,c,u,p,w,g,v,C,f,_,R,S,b,y;if((e=e||this._options.autosizeColsMode)===r.LegacyForceFit||e===r.LegacyOff)return void this.legacyAutosizeColumns();if(e===r.None)return;this.canvas=document.createElement("canvas"),null!=(i=this.canvas)&&i.getContext&&(this.canvas_context=this.canvas.getContext("2d"));let H,E,P,z=this.getCanvasNode(0,0),L=this.getViewportInnerWidth(),x=!1,k=0,D=0,F=0,T=0,W=0;for(H=0;H<this.columns.length;H++)E=this.columns[H],this.getColAutosizeWidth(E,H,z,t||!1,H),W+=(null==(s=E.autoSize)?void 0:s.autosizeMode)===o.Locked?E.width||0:this.treatAsLocked(E.autoSize)&&(null==(l=E.autoSize)?void 0:l.widthPx)||0,T+=(null==(n=E.autoSize)?void 0:n.autosizeMode)===o.Locked?E.width||0:this.treatAsLocked(E.autoSize)?(null==(h=E.autoSize)?void 0:h.widthPx)||0:E.minWidth||0,k+=(null==(a=E.autoSize)?void 0:a.widthPx)||0,D+=null!=(d=E.autoSize)&&d.sizeToRemaining?0:(null==(c=E.autoSize)?void 0:c.widthPx)||0,F+=null!=(u=E.autoSize)&&u.sizeToRemaining&&E.minWidth||0;let A=k-D;if(e===r.FitViewportToCols){let t=k+(null!=(w=null==(p=this.scrollbarDimensions)?void 0:p.width)?w:0);e=r.IgnoreViewport,this._options.viewportMaxWidthPx&&t>this._options.viewportMaxWidthPx?(t=this._options.viewportMaxWidthPx,e=r.FitColsToViewport):this._options.viewportMinWidthPx&&t<this._options.viewportMinWidthPx&&(t=this._options.viewportMinWidthPx,e=r.FitColsToViewport),m.width(this._container,t)}if(e===r.FitColsToViewport)if(A>0&&D<L-F)for(H=0;H<this.columns.length;H++){if(E=this.columns[H],!E||E.hidden)continue;let e=L-D;P=null!=(g=E.autoSize)&&g.sizeToRemaining?e*((null==(v=E.autoSize)?void 0:v.widthPx)||0)/A:(null==(C=E.autoSize)?void 0:C.widthPx)||0,E.rerenderOnResize&&(E.width||0)!==P&&(x=!0),E.width=P}else if(this._options.viewportSwitchToScrollModeWidthPercent&&D+F>L*this._options.viewportSwitchToScrollModeWidthPercent/100||T>L)e=r.IgnoreViewport;else{let e=D-W,t=L-W-F;for(H=0;H<this.columns.length;H++)E=this.columns[H],E&&!E.hidden&&(P=E.width||0,(null==(f=E.autoSize)?void 0:f.autosizeMode)!==o.Locked&&!this.treatAsLocked(E.autoSize)&&(null!=(_=E.autoSize)&&_.sizeToRemaining?P=E.minWidth||0:(P=t/e*((null==(R=E.autoSize)?void 0:R.widthPx)||0)-1,P<(E.minWidth||0)&&(P=E.minWidth||0),e-=(null==(S=E.autoSize)?void 0:S.widthPx)||0,t-=P)),this.treatAsLocked(E.autoSize)&&(P=(null==(b=E.autoSize)?void 0:b.widthPx)||0,P<(E.minWidth||0)&&(P=E.minWidth||0)),E.rerenderOnResize&&E.width!==P&&(x=!0),E.width=P)}if(e===r.IgnoreViewport)for(H=0;H<this.columns.length;H++)!this.columns[H]||this.columns[H].hidden||(P=(null==(y=this.columns[H].autoSize)?void 0:y.widthPx)||0,this.columns[H].rerenderOnResize&&this.columns[H].width!==P&&(x=!0),this.columns[H].width=P);this.reRenderColumns(x)}getColAutosizeWidth(e,t,i,s,l){var n;let r=e.autoSize;if(r.widthPx=e.width,r.autosizeMode===o.Locked||r.autosizeMode===o.Guide)return;let h=this.getDataLength(),a=new RegExp(/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{3})?Z/);if(r.autosizeMode===o.ContentIntelligent){let t,i=r.colDataTypeOf;if(h>0){let o=this.getDataItem(0);o&&(t=o[e.field],a.test(t)&&(t=Date.parse(t)),i=typeof t,"object"===i&&(t instanceof Date&&(i="date"),"undefined"!=typeof moment&&t instanceof moment&&(i="moment")))}"boolean"===i&&(r.colValueArray=[!0,!1]),"number"===i&&(r.valueFilterMode=p.GetGreatestAndSub,r.rowSelectionMode=c.AllRows),"string"===i&&(r.valueFilterMode=p.GetLongestText,r.rowSelectionMode=c.AllRows,r.allowAddlPercent=5),"date"===i&&(r.colValueArray=[new Date(2009,8,30,12,20,20)]),"moment"===i&&"undefined"!=typeof moment&&(r.colValueArray=[moment([2009,8,30,12,20,20])])}let d=r.contentSizePx=this.getColContentSize(e,t,i,s,l);0===d&&(d=r.widthPx||0),d=d*(r.allowAddlPercent?1+r.allowAddlPercent/100:1)+(this._options.autosizeColPaddingPx||0),e.minWidth&&d<e.minWidth&&(d=e.minWidth),e.maxWidth&&d>e.maxWidth&&(d=e.maxWidth),(r.autosizeMode===o.ContentExpandOnly||null!=(n=null==e?void 0:e.editor)&&n.ControlFillsColumn)&&d<(e.width||0)&&(d=e.width||0),r.widthPx=d}getColContentSize(e,t,i,o,s){let l,n,r=e.autoSize,h=1,a=0,d=0;if(r.headerWidthPx=0,r.ignoreHeaderText||(r.headerWidthPx=this.getColHeaderWidth(e)),0===r.headerWidthPx&&(r.headerWidthPx=e.width?e.width:e.maxWidth?e.maxWidth:e.minWidth?e.minWidth:20),r.colValueArray)return d=this.getColWidth(e,i,r.colValueArray),Math.max(r.headerWidthPx,d);let u={};u.colIndex=t,u.rowCount=this.getDataLength(),u.startIndex=0,u.endIndex=u.rowCount-1,u.valueArr=null,u.getRowVal=t=>this.getDataItem(t)[e.field];let m=(o?r.rowSelectionModeOnInit:void 0)||r.rowSelectionMode;if(m===c.FirstRow&&(u.endIndex=0),m===c.LastRow&&(u.endIndex=u.startIndex=u.rowCount-1),m===c.FirstNRows&&(u.endIndex=Math.min(r.rowSelectionCount||0,u.rowCount)-1),r.valueFilterMode===p.DeDuplicate){let e={};for(l=u.startIndex;l<=u.endIndex;l++)e[u.getRowVal(l)]=!0;if(Object.keys)u.valueArr=Object.keys(e);else{u.valueArr=[];for(let t in e)e&&u.valueArr.push(t)}u.startIndex=0,u.endIndex=u.length-1}if(r.valueFilterMode===p.GetGreatestAndSub){let e,t=0;for(l=u.startIndex;l<=u.endIndex;l++)n=u.getRowVal(l),Math.abs(n)>t&&(e=n,t=Math.abs(n));e=""+e,e=Array(e.length+1).join("9"),e=+e,u.valueArr=[e],u.startIndex=u.endIndex=0}if(r.valueFilterMode===p.GetLongestTextAndSub){for(l=u.startIndex;l<=u.endIndex;l++)n=u.getRowVal(l),(n||"").length>a&&(a=n.length);n=Array(a+1).join("m"),h=this._options.autosizeTextAvgToMWidthRatio||0,u.maxLen=a,u.valueArr=[n],u.startIndex=u.endIndex=0}if(r.valueFilterMode===p.GetLongestText){a=0;let e=0;for(l=u.startIndex;l<=u.endIndex;l++)n=u.getRowVal(l),(n||"").length>a&&(a=n.length,e=l);n=u.getRowVal(e),u.maxLen=a,u.valueArr=[n],u.startIndex=u.endIndex=0}return u.maxLen&&u.maxLen>30&&s>1&&(r.sizeToRemaining=!0),d=this.getColWidth(e,i,u)*h,Math.max(r.headerWidthPx,d)}getColWidth(e,t,i){var o,s,l;let n=m.createDomElement("div",{className:"slick-row ui-widget-content"},t),r=m.createDomElement("div",{className:"slick-cell"},n);r.style.position="absolute",r.style.visibility="hidden",r.style.textOverflow="initial",r.style.whiteSpace="nowrap";let h,a,d,c,u=0,p="",w=e.autoSize.widthEvalMode===g.TextOnly;if((null==(o=e.autoSize)?void 0:o.widthEvalMode)===g.Auto){let t=!e.formatterOverride&&!e.formatter,i=(null==(s=null==e?void 0:e.formatterOverride)?void 0:s.ReturnsTextOnly)||!e.formatterOverride&&(null==(l=e.formatter)?void 0:l.ReturnsTextOnly);w=t||i}if(this.canvas_context&&w){let t=getComputedStyle(r);for(this.canvas_context.font=t.fontSize+" "+t.fontFamily,h=i.startIndex;h<=i.endIndex;h++)c=i.valueArr?i.valueArr[h]:i.getRowVal(h),d=e.formatterOverride?e.formatterOverride(h,i.colIndex,c,e,this.getDataItem(h),this):e.formatter?e.formatter(h,i.colIndex,c,e,this.getDataItem(h),this):""+c,a=d?this.canvas_context.measureText(d).width:0,a>u&&(u=a,p=d);return r.textContent=p,a=r.offsetWidth,n.remove(),a}for(h=i.startIndex;h<=i.endIndex;h++)c=i.valueArr?i.valueArr[h]:i.getRowVal(h),d=e.formatterOverride?e.formatterOverride(h,i.colIndex,c,e,this.getDataItem(h),this):e.formatter?e.formatter(h,i.colIndex,c,e,this.getDataItem(h),this):""+c,this.applyFormatResultToCellNode(d,r),a=r.offsetWidth,a>u&&(u=a);return n.remove(),u}getColHeaderWidth(e){let t=0,i=this.getUID()+e.id,o=document.getElementById(i),s=`${i}_`,l=o.cloneNode(!0);if(o)l.id=s,l.style.cssText="position: absolute; visibility: hidden;right: auto;text-overflow: initial;white-space: nowrap;",o.parentNode.insertBefore(l,o),t=l.offsetWidth,l.parentNode.removeChild(l);else{let i=this.getHeader(e);o=m.createDomElement("div",{id:s,className:"ui-state-default slick-state-default slick-header-column"},i);let n=m.createDomElement("span",{className:"slick-column-name"},o);this.applyHtmlCode(n,e.name),l.style.cssText="position: absolute; visibility: hidden;right: auto;text-overflow: initial;white-space: nowrap;",e.headerCssClass&&o.classList.add(...m.classNameToList(e.headerCssClass)),t=o.offsetWidth,i.removeChild(o)}return t}legacyAutosizeColumns(){let e,t,i=0,o=0,s=0,l=[],n=this.getViewportInnerWidth();for(e=0;e<this.columns.length;e++)t=this.columns[e],t&&!t.hidden?(l.push(t.width||0),o+=t.width||0,t.resizable&&(i+=(t.width||0)-Math.max(t.minWidth||0,this.absoluteColumnMinWidth))):l.push(0);for(s=o;o>n&&i;){let r=(o-n)/i;for(e=0;e<this.columns.length&&o>n;e++){if(t=this.columns[e],!t||t.hidden)continue;let s=l[e];if(!t.resizable||s<=t.minWidth||s<=this.absoluteColumnMinWidth)continue;let n=Math.max(t.minWidth,this.absoluteColumnMinWidth),h=Math.floor(r*(s-n))||1;h=Math.min(h,s-n),o-=h,i-=h,l[e]-=h}if(s<=o)break;s=o}for(s=o;o<n;){let i=n/o;for(e=0;e<this.columns.length&&o<n;e++){if(t=this.columns[e],!t||t.hidden)continue;let s,r=l[e];s=!t.resizable||t.maxWidth<=r?0:Math.min(Math.floor(i*r)-r,t.maxWidth-r||1e6)||1,o+=s,l[e]+=o<=n?s:0}if(s>=o)break;s=o}let r=!1;for(e=0;e<this.columns.length;e++)!t||t.hidden||(this.columns[e].rerenderOnResize&&this.columns[e].width!==l[e]&&(r=!0),this.columns[e].width=l[e]);this.reRenderColumns(r)}reRenderColumns(e){this.applyColumnHeaderWidths(),this.updateCanvasWidth(!0),this.trigger(this.onAutosizeColumns,{columns:this.columns}),e&&(this.invalidateAllRows(),this.render())}getVisibleColumns(){return this.columns.filter((e=>!e.hidden))}getColumnIndex(e){return this.columnsById[e]}applyColumnHeaderWidths(){if(!this.initialized)return;let e=0,t=this.getVisibleColumns();this._headers.forEach((i=>{for(let o=0;o<i.children.length;o++,e++){let s=i.children[o],l=((t[e]||{}).width||0)-this.headerColumnWidthDiff;m.width(s)!==l&&m.width(s,l)}})),this.updateColumnCaches()}applyColumnWidths(){var e;let t,i=0,o=0;for(let s=0;s<this.columns.length;s++)null!=(e=this.columns[s])&&e.hidden||(o=this.columns[s].width||0,t=this.getColumnCssRules(s),t.left.style.left=`${i}px`,t.right.style.right=(-1!==this._options.frozenColumn&&s>this._options.frozenColumn?this.canvasWidthR:this.canvasWidthL)-i-o+"px",this._options.frozenColumn!==s&&(i+=this.columns[s].width)),this._options.frozenColumn===s&&(i=0)}setSortColumn(e,t){this.setSortColumns([{columnId:e,sortAsc:t}])}getColumnByIndex(e){let t;return this._headers.every((i=>{let o=i.children.length;return e<o?(t=i.children[e],!1):(e-=o,!0)})),t}setSortColumns(e){this.sortColumns=e;let t=this._options.numberedMultiColumnSort&&this.sortColumns.length>1;this._headers.forEach((e=>{let t=e.querySelectorAll(".slick-header-column-sorted");t.forEach((e=>{e.classList.remove("slick-header-column-sorted")})),t=e.querySelectorAll(".slick-sort-indicator"),t.forEach((e=>{e.classList.remove("slick-sort-indicator-asc"),e.classList.remove("slick-sort-indicator-desc")})),t=e.querySelectorAll(".slick-sort-indicator-numbered"),t.forEach((e=>{e.textContent=""}))}));let i=1;this.sortColumns.forEach((e=>{m.isDefined(e.sortAsc)||(e.sortAsc=!0);let o=this.getColumnIndex(e.columnId);if(m.isDefined(o)){let s=this.getColumnByIndex(o);if(s){s.classList.add("slick-header-column-sorted");let o=s.querySelector(".slick-sort-indicator");null==o||o.classList.add(e.sortAsc?"slick-sort-indicator-asc":"slick-sort-indicator-desc"),t&&(o=s.querySelector(".slick-sort-indicator-numbered"),o&&(o.textContent=String(i)))}}i++}))}getColumns(){return this.columns}getSortColumns(){return this.sortColumns}updateColumnCaches(){this.columnPosLeft=[],this.columnPosRight=[];let e=0;for(let t=0,i=this.columns.length;t<i;t++)!this.columns[t]||this.columns[t].hidden||(this.columnPosLeft[t]=e,this.columnPosRight[t]=e+(this.columns[t].width||0),this._options.frozenColumn===t?e=0:e+=this.columns[t].width||0)}updateColumnProps(){this.columnsById={};for(let e=0;e<this.columns.length;e++){let t=this.columns[e];t.width&&(t.widthRequest=t.width),this._options.mixinDefaults?(m.applyDefaults(t,this._columnDefaults),t.autoSize||(t.autoSize={}),m.applyDefaults(t.autoSize,this._columnAutosizeDefaults)):(t=this.columns[e]=m.extend({},this._columnDefaults,t),t.autoSize=m.extend({},this._columnAutosizeDefaults,t.autoSize)),this.columnsById[t.id]=e,t.minWidth&&(t.width||0)<t.minWidth&&(t.width=t.minWidth),t.maxWidth&&(t.width||0)>t.maxWidth&&(t.width=t.maxWidth)}}setColumns(e){this.trigger(this.onBeforeSetColumns,{previousColumns:this.columns,newColumns:e,grid:this}),this.columns=e,this.updateColumnsInternal(),this.trigger(this.onAfterSetColumns,{newColumns:e,grid:this})}updateColumns(){this.trigger(this.onBeforeUpdateColumns,{columns:this.columns,grid:this}),this.updateColumnsInternal()}updateColumnsInternal(){var e;this.updateColumnProps(),this.updateColumnCaches(),this.initialized&&(this.setPaneFrozenClasses(),this.setPaneVisibility(),this.setOverflow(),this.invalidateAllRows(),this.createColumnHeaders(),this.createColumnFooter(),this.removeCssRules(),this.createCssRules(),this.resizeCanvas(),this.updateCanvasWidth(),this.applyColumnHeaderWidths(),this.applyColumnWidths(),this.handleScroll(),null==(e=this.getSelectionModel())||e.refreshSelections())}getEditorLock(){return this._options.editorLock}getEditController(){return this.editController}setData(e,t){this.data=e,this.invalidateAllRows(),this.updateRowCount(),t&&this.scrollTo(0)}getData(){return this.data}getDataLength(){var e,t;return this.data.getLength?this.data.getLength():null!=(t=null==(e=this.data)?void 0:e.length)?t:0}getDataLengthIncludingAddNew(){return this.getDataLength()+(!this._options.enableAddRow||this.pagingActive&&!this.pagingIsLastPage?0:1)}getDataItem(e){return this.data.getItem?this.data.getItem(e):this.data[e]}hasDataView(){return!Array.isArray(this.data)}getItemMetadaWhenExists(e){return"getItemMetadata"in this.data?this.data.getItemMetadata(e):null}getFormatter(e,t){var i,o,s;let l=null==(o=null==(i=this.data)?void 0:i.getItemMetadata)?void 0:o.call(i,e),n=(null==l?void 0:l.columns)&&(l.columns[t.id]||l.columns[this.getColumnIndex(t.id)]);return(null==n?void 0:n.formatter)||(null==l?void 0:l.formatter)||t.formatter||(null==(s=this._options.formatterFactory)?void 0:s.getFormatter(t))||this._options.defaultFormatter}getEditor(e,t){var i,o,s,l;let n=this.columns[t],r=this.getItemMetadaWhenExists(e),h=null==r?void 0:r.columns;return void 0!==(null==(i=null==h?void 0:h[n.id])?void 0:i.editor)?h[n.id].editor:void 0!==(null==(o=null==h?void 0:h[t])?void 0:o.editor)?h[t].editor:n.editor||(null==(l=null==(s=this._options)?void 0:s.editorFactory)?void 0:l.getEditor(n))}getDataItemValueForColumn(e,t){return this._options.dataItemColumnValueExtractor?this._options.dataItemColumnValueExtractor(e,t):e[t.field]}resetActiveCell(){this.setActiveCellInternal(null,!1)}unsetActiveCell(){var e,t;m.isDefined(this.activeCellNode)&&(this.makeActiveCellNormal(),this.activeCellNode.classList.remove("active"),null==(t=null==(e=this.rowsCache[this.activeRow])?void 0:e.rowNode)||t.forEach((e=>e.classList.remove("active"))))}focus(){this.setFocus()}setFocus(){-1===this.tabbingDirection?this._focusSink.focus():this._focusSink2.focus()}setActiveCellInternal(e,t,i,o,s){var l,n;if(this.unsetActiveCell(),this.activeCellNode=e,m.isDefined(this.activeCellNode)){let e=m.offset(this.activeCellNode),o=Math.floor(m.offset(m.parents(this.activeCellNode,".grid-canvas")[0]).top),r=m.parents(this.activeCellNode,".grid-canvas-bottom").length;this.hasFrozenRows&&r&&(o-=this._options.frozenBottom?m.height(this._canvasTopL):this.frozenRowsHeight);let h=this.getCellFromPoint(e.left,Math.ceil(e.top)-o);this.activeRow=h.row,this.activePosY=h.row,this.activeCell=this.activePosX=this.getCellFromNode(this.activeCellNode),!m.isDefined(t)&&this._options.autoEditNewRow&&(t=this.activeRow===this.getDataLength()||this._options.autoEdit),this._options.showCellSelection&&(document.querySelectorAll(".slick-cell.active").forEach((e=>e.classList.remove("active"))),this.activeCellNode.classList.add("active"),null==(n=null==(l=this.rowsCache[this.activeRow])?void 0:l.rowNode)||n.forEach((e=>e.classList.add("active")))),this._options.editable&&t&&this.isCellPotentiallyEditable(this.activeRow,this.activeCell)&&(this._options.asyncEditorLoading?(window.clearTimeout(this.h_editorLoader),this.h_editorLoader=window.setTimeout((()=>{this.makeActiveCellEditable(void 0,i,s)}),this._options.asyncEditorLoadDelay)):this.makeActiveCellEditable(void 0,i,s))}else this.activeRow=this.activeCell=null;o||this.trigger(this.onActiveCellChanged,this.getActiveCell())}isCellPotentiallyEditable(e,t){let i=this.getDataLength();return!(e<i&&!this.getDataItem(e)||this.columns[t].cannotTriggerInsert&&e>=i||!this.columns[t]||this.columns[t].hidden||!this.getEditor(e,t))}makeActiveCellNormal(e=!1){var t;if(this.currentEditor){if(this.trigger(this.onBeforeCellEditorDestroy,{editor:this.currentEditor}),this.currentEditor.destroy(),this.currentEditor=null,this.activeCellNode){let t=this.getDataItem(this.activeRow);if(this.activeCellNode.classList.remove("editable"),this.activeCellNode.classList.remove("invalid"),t){let e=this.columns[this.activeCell],i=this.getFormatter(this.activeRow,e)(this.activeRow,this.activeCell,this.getDataItemValueForColumn(t,e),e,t,this);this.applyFormatResultToCellNode(i,this.activeCellNode),this.invalidatePostProcessingResults(this.activeRow)}e&&this.setFocus()}navigator.userAgent.toLowerCase().match(/msie/)&&this.clearTextSelection(),null==(t=this.getEditorLock())||t.deactivate(this.editController)}}editActiveCell(e,t,i){this.makeActiveCellEditable(e,t,i)}makeActiveCellEditable(e,t,i){var o,s,l,n;if(!this.activeCellNode)return;if(!this._options.editable)throw new Error("SlickGrid makeActiveCellEditable : should never get called when this._options.editable is false");if(window.clearTimeout(this.h_editorLoader),!this.isCellPotentiallyEditable(this.activeRow,this.activeCell))return;let r=this.columns[this.activeCell],h=this.getDataItem(this.activeRow);if(!1===this.trigger(this.onBeforeEditCell,{row:this.activeRow,cell:this.activeCell,item:h,column:r,target:"grid"}).getReturnValue())return void this.setFocus();null==(o=this.getEditorLock())||o.activate(this.editController),this.activeCellNode.classList.add("editable");let a=e||this.getEditor(this.activeRow,this.activeCell);if(!a||"function"!=typeof a)return;!e&&!a.suppressClearOnEdit&&m.emptyElement(this.activeCellNode);let d=this.getItemMetadaWhenExists(this.activeRow);d=null==d?void 0:d.columns;let c=d&&(d[r.id]||d[this.activeCell]),u={grid:this,gridPosition:this.absBox(this._container),position:this.absBox(this.activeCellNode),container:this.activeCellNode,column:r,columnMetaData:c,item:h||{},event:i,commitChanges:this.commitEditAndSetFocus.bind(this),cancelChanges:this.cancelEditAndSetFocus.bind(this)};this.currentEditor=new a(u),h&&this.currentEditor&&(this.currentEditor.loadValue(h),t&&null!=(s=this.currentEditor)&&s.preClick&&this.currentEditor.preClick()),this.serializedEditorValue=null==(l=this.currentEditor)?void 0:l.serializeValue(),null!=(n=this.currentEditor)&&n.position&&this.handleActiveCellPositionChange()}commitEditAndSetFocus(){var e;null!=(e=this.getEditorLock())&&e.commitCurrentEdit()&&(this.setFocus(),this._options.autoEdit&&!this._options.autoCommitEdit&&this.navigateDown())}cancelEditAndSetFocus(){var e;null!=(e=this.getEditorLock())&&e.cancelCurrentEdit()&&this.setFocus()}commitCurrentEdit(){var e;let t=this,i=t.getDataItem(t.activeRow),o=t.columns[t.activeCell];if(t.currentEditor){if(t.currentEditor.isValueChanged()){let s=t.currentEditor.validate(void 0,{rowIndex:t.activeRow,cellIndex:t.activeCell});if(s.valid){let s=t.activeRow,l=t.activeCell,n=t.currentEditor,r=t.currentEditor.serializeValue(),h=t.serializedEditorValue;if(t.activeRow<t.getDataLength()){let e={row:s,cell:l,editor:n,serializedValue:r,prevSerializedValue:h,execute:()=>{n.applyValue(i,r),t.updateRow(s),t.trigger(t.onCellChange,{command:"execute",row:s,cell:l,item:i,column:o})},undo:()=>{n.applyValue(i,h),t.updateRow(s),t.trigger(t.onCellChange,{command:"undo",row:s,cell:l,item:i,column:o})}};t._options.editCommandHandler?(t.makeActiveCellNormal(!0),t._options.editCommandHandler(i,o,e)):(e.execute(),t.makeActiveCellNormal(!0))}else{let e={};t.currentEditor.applyValue(e,t.currentEditor.serializeValue()),t.makeActiveCellNormal(!0),t.trigger(t.onAddNewRow,{item:e,column:o})}return!(null!=(e=t.getEditorLock())&&e.isActive())}return t.activeCellNode&&(t.activeCellNode.classList.remove("invalid"),m.width(t.activeCellNode),t.activeCellNode.classList.add("invalid")),t.trigger(t.onValidationError,{editor:t.currentEditor,cellNode:t.activeCellNode,validationResults:s,row:t.activeRow,cell:t.activeCell,column:o}),t.currentEditor.focus(),!1}t.makeActiveCellNormal(!0)}return!0}cancelCurrentEdit(){return this.makeActiveCellNormal(),!0}getSelectedRows(){if(!this.selectionModel)throw new Error("SlickGrid Selection model is not set");return this.selectedRows.slice(0)}setSelectedRows(e,t){var i;if(!this.selectionModel)throw new Error("SlickGrid Selection model is not set");this&&this.getEditorLock&&(null==(i=this.getEditorLock())||!i.isActive())&&this.selectionModel.setSelectedRanges(this.rowsToRanges(e),t||"SlickGrid.setSelectedRows")}trigger(e,t,i){let o=i||new l(i,t),s=t||{};return s.grid=this,e.notify(s,o,this)}handleCellMouseOut(e){this.trigger(this.onMouseLeave,{},e)}handleHeaderMouseHoverOn(e){null==e||e.target.classList.add("ui-state-hover","slick-state-hover")}handleHeaderMouseHoverOff(e){null==e||e.target.classList.remove("ui-state-hover","slick-state-hover")}handleSelectedRangesChanged(e,t){var i,o,s,l,n;let r=e.getNativeEvent(),h=null!=(o=null==(i=null==r?void 0:r.detail)?void 0:i.selectionMode)?o:"",a=!(null==(s=null==r?void 0:r.detail)||!s.addDragHandle),d=this.selectedRanges.slice(0);if(this.selectedRanges=t,h===u.Replace&&d&&1===d.length&&this.selectedRanges&&1===this.selectedRanges.length){let e=d[0],t=this.selectedRanges[0];w.copyRangeIsLarger(e,t)&&(this.trigger(this.onDragReplaceCells,{prevSelectedRange:e,selectedRange:t}),this.invalidate())}let c=this.selectedRows.slice(0);this.selectionBottomRow=-1,this.selectionRightCell=-1,this.dragReplaceEl.removeEl(),this.selectedRows=[];let p={};for(let e=0;e<t.length;e++){for(let i=t[e].fromRow;i<=t[e].toRow;i++){p[i]||(this.selectedRows.push(i),p[i]={});for(let o=t[e].fromCell;o<=t[e].toCell;o++)this.canCellBeSelected(i,o)&&(p[i][this.columns[o].id]=this._options.selectedCellCssClass)}this.selectionBottomRow<t[e].toRow&&(this.selectionBottomRow=t[e].toRow),this.selectionRightCell<t[e].toCell&&(this.selectionRightCell=t[e].toCell)}if(this.setCellCssStyles(this._options.selectedCellCssClass||"",p),this.selectionBottomRow>=0&&this.selectionRightCell>=0&&a){let e=this.getCellNode(this.selectionBottomRow,this.selectionRightCell);this.dragReplaceEl.createEl(e)}if(!this.arrayEquals(c.sort(),this.selectedRows.sort())){let t=null!=(n=null==(l=null==r?void 0:r.detail)?void 0:l.caller)?n:"click",i=new Set(this.getSelectedRows()),o=new Set(c),s=Array.from(i).filter((e=>!o.has(e))),h=Array.from(o).filter((e=>!i.has(e)));this.trigger(this.onSelectedRowsChanged,{rows:this.getSelectedRows(),previousSelectedRows:c,caller:t,changedSelectedRows:s,changedUnselectedRows:h},e)}}handleMouseWheel(e,t,i,o){this.scrollHeight=this._viewportScrollContainerY.scrollHeight,e.shiftKey||(this.scrollTop=Math.max(0,this._viewportScrollContainerY.scrollTop-o*this._options.rowHeight)),this.scrollLeft=this._viewportScrollContainerX.scrollLeft+10*i,this._handleScroll("mousewheel")&&e.stopPropagation()}handleDragInit(e,t){let i=this.getCellFromEvent(e);if(!i||!this.cellExists(i.row,i.cell))return!1;let o=this.trigger(this.onDragInit,t,e);return!!o.isImmediatePropagationStopped()&&o.getReturnValue()}handleDragStart(e,t){let i=this.getCellFromEvent(e);if(!i||!this.cellExists(i.row,i.cell)||this.currentEditor&&!this.getEditorLock().commitCurrentEdit())return!1;let o=this.trigger(this.onDragStart,t,e);return!!o.isImmediatePropagationStopped()&&o.getReturnValue()}handleDrag(e,t){return this.trigger(this.onDrag,t,e).getReturnValue()}handleDragEnd(e,t){this.trigger(this.onDragEnd,t,e)}handleKeyDown(e){var t,i,o,s;let l=this.trigger(this.onKeyDown,{row:this.activeRow,cell:this.activeCell},e).isImmediatePropagationStopped();if(!l&&!e.shiftKey&&!e.altKey){if(this._options.editable&&null!=(t=this.currentEditor)&&t.keyCaptureList&&this.currentEditor.keyCaptureList.indexOf(e.which)>-1)return;e.ctrlKey&&"Home"===e.key?this.navigateTopStart():e.ctrlKey&&"End"===e.key?this.navigateBottomEnd():e.ctrlKey&&"ArrowUp"===e.key?this.navigateTop():e.ctrlKey&&"ArrowDown"===e.key?this.navigateBottom():e.ctrlKey&&"ArrowLeft"===e.key||!e.ctrlKey&&"Home"===e.key?this.navigateRowStart():(e.ctrlKey&&"ArrowRight"===e.key||!e.ctrlKey&&"End"===e.key)&&this.navigateRowEnd()}if(!l)if(e.shiftKey||e.altKey||e.ctrlKey)e.which===h.TAB&&e.shiftKey&&!e.ctrlKey&&!e.altKey&&(l=this.navigatePrev());else{if(this._options.editable&&null!=(i=this.currentEditor)&&i.keyCaptureList&&this.currentEditor.keyCaptureList.indexOf(e.which)>-1)return;if(e.which===h.ESCAPE){if(null==(o=this.getEditorLock())||!o.isActive())return;this.cancelEditAndSetFocus()}else e.which===h.PAGE_DOWN?(this.navigatePageDown(),l=!0):e.which===h.PAGE_UP?(this.navigatePageUp(),l=!0):e.which===h.LEFT?l=this.navigateLeft():e.which===h.RIGHT?l=this.navigateRight():e.which===h.UP?l=this.navigateUp():e.which===h.DOWN?l=this.navigateDown():e.which===h.TAB?l=this.navigateNext():e.which===h.ENTER&&(this._options.editable&&(this.currentEditor?this.activeRow===this.getDataLength()?this.navigateDown():this.commitEditAndSetFocus():null!=(s=this.getEditorLock())&&s.commitCurrentEdit()&&this.makeActiveCellEditable(void 0,void 0,e)),l=!0)}if(l){e.stopPropagation(),e.preventDefault();try{e.originalEvent.keyCode=0}catch(e){}}}handleClick(e){var t,i,o,s;let n=e instanceof l?e.getNativeEvent():e;if(!this.currentEditor&&(n.target!==document.activeElement||n.target.classList.contains("slick-cell"))){let e=this.getTextSelection();this.setFocus(),this.setTextSelection(e)}let r=this.getCellFromEvent(n);if(r&&(null===this.currentEditor||this.activeRow!==r.row||this.activeCell!==r.cell)&&(!(e=this.trigger(this.onClick,{row:r.row,cell:r.cell},e||n)).isImmediatePropagationStopped()&&this.canCellBeActive(r.row,r.cell)&&(null==(t=this.getEditorLock())||!t.isActive()||null!=(i=this.getEditorLock())&&i.commitCurrentEdit()))){this.scrollRowIntoView(r.row,!1);let e=!(null==(s=null==(o=n.target)?void 0:o.classList)||!s.contains(a)),t=this.columns[r.cell],i=!!(this._options.editable&&null!=t&&t.editor&&this._options.suppressActiveCellChangeOnEdit);this.setActiveCellInternal(this.getCellNode(r.row,r.cell),null,e,i,n)}}handleContextMenu(e){let t=e.target.closest(".slick-cell");t&&(this.activeCellNode===t&&null!==this.currentEditor||this.trigger(this.onContextMenu,{},e))}handleDblClick(e){let t=this.getCellFromEvent(e);!t||null!==this.currentEditor&&this.activeRow===t.row&&this.activeCell===t.cell||(this.trigger(this.onDblClick,{row:t.row,cell:t.cell},e),!e.defaultPrevented&&this._options.editable&&this.gotoCell(t.row,t.cell,!0,e))}handleHeaderMouseEnter(e){let t=m.storage.get(e.target.closest(".slick-header-column"),"column");t&&this.trigger(this.onHeaderMouseEnter,{column:t,grid:this},e)}handleHeaderMouseLeave(e){let t=m.storage.get(e.target.closest(".slick-header-column"),"column");t&&this.trigger(this.onHeaderMouseLeave,{column:t,grid:this},e)}handleHeaderRowMouseEnter(e){let t=m.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&this.trigger(this.onHeaderRowMouseEnter,{column:t,grid:this},e)}handleHeaderRowMouseLeave(e){let t=m.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&this.trigger(this.onHeaderRowMouseLeave,{column:t,grid:this},e)}handleHeaderContextMenu(e){let t=e.target.closest(".slick-header-column"),i=t&&m.storage.get(t,"column");this.trigger(this.onHeaderContextMenu,{column:i},e)}handleHeaderClick(e){if(!this.columnResizeDragging){let t=e.target.closest(".slick-header-column"),i=t&&m.storage.get(t,"column");i&&this.trigger(this.onHeaderClick,{column:i},e)}}handlePreHeaderContextMenu(e){this.trigger(this.onPreHeaderContextMenu,{node:e.target},e)}handlePreHeaderClick(e){this.columnResizeDragging||this.trigger(this.onPreHeaderClick,{node:e.target},e)}handleFooterContextMenu(e){let t=e.target.closest(".slick-footerrow-column"),i=t&&m.storage.get(t,"column");this.trigger(this.onFooterContextMenu,{column:i},e)}handleFooterClick(e){let t=e.target.closest(".slick-footerrow-column"),i=t&&m.storage.get(t,"column");this.trigger(this.onFooterClick,{column:i},e)}handleCellMouseOver(e){this.trigger(this.onMouseEnter,{},e)}handleActiveCellPositionChange(){if(this.activeCellNode&&(this.trigger(this.onActiveCellPositionChanged,{}),this.currentEditor)){let e=this.getActiveCellPosition();this.currentEditor.show&&this.currentEditor.hide&&(e.visible?this.currentEditor.show():this.currentEditor.hide()),this.currentEditor.position&&this.currentEditor.position(e)}}actionThrottle(e,t){let i=!1,o=!1,s=()=>{o=!1},l=()=>{i=!0,window.clearTimeout(this._executionBlockTimer),this._executionBlockTimer=window.setTimeout(n,t),e.call(this)},n=()=>{o?(s(),l()):i=!1};return{enqueue:(()=>{i?o=!0:l()}).bind(this),dequeue:s.bind(this)}}getCellFromEvent(e){let t=e instanceof l?e.getNativeEvent():e,i=t.touches?t.touches[0]:t,o=t.target.closest(".slick-cell");if(!o)return null;let s=this.getRowFromNode(o.parentNode);if(this.hasFrozenRows){let e=0,t=m.offset(m.parents(o,".grid-canvas")[0]);m.parents(o,".grid-canvas-bottom").length&&(e=this._options.frozenBottom?m.height(this._canvasTopL):this.frozenRowsHeight),s=this.getCellFromPoint(i.clientX-t.left,i.clientY-t.top+e+document.documentElement.scrollTop).row}let n=this.getCellFromNode(o);return m.isDefined(s)&&m.isDefined(n)?{row:s,cell:n}:null}applyHtmlCode(e,t,i){if(e)if(t instanceof HTMLElement||t instanceof DocumentFragment)!1!==(null==i?void 0:i.emptyTarget)&&m.emptyElement(e),e.appendChild(t);else{if(!1!==(null==i?void 0:i.skipEmptyReassignment)&&!m.isDefined(t)&&!e.innerHTML)return;let o=t;"number"==typeof o||"boolean"==typeof o?e.textContent=o:(o=this.sanitizeHtmlString(t),this._options.enableHtmlRendering&&o?e.innerHTML=o:e.textContent=o)}}getCanvasNode(e,t){return this._getContainerElement(this.getCanvases(),e,t)}getActiveCanvasNode(e){return void 0===e||(e instanceof l&&(e=e.getNativeEvent()),this._activeCanvasNode=null==e?void 0:e.target.closest(".grid-canvas")),this._activeCanvasNode}getCanvases(){return this._canvas}getViewportNode(e,t){return this._getContainerElement(this.getViewports(),e,t)}getViewports(){return this._viewport}getActiveViewportNode(e){return this.setActiveViewportNode(e),this._activeViewportNode}setActiveViewportNode(e){return e instanceof l&&(e=e.getNativeEvent()),this._activeViewportNode=null==e?void 0:e.target.closest(".slick-viewport"),this._activeViewportNode}getHeadersWidth(){var e,t,i,o,s,l,n,r;this.headersWidth=this.headersWidthL=this.headersWidthR=0;let h=!this._options.autoHeight,a=0,d=this.columns.length;for(a=0;a<d;a++){if(!this.columns[a]||this.columns[a].hidden)continue;let e=this.columns[a].width;this._options.frozenColumn>-1&&a>this._options.frozenColumn?this.headersWidthR+=e||0:this.headersWidthL+=e||0}return h&&(this._options.frozenColumn>-1&&a>this._options.frozenColumn?this.headersWidthR+=null!=(t=null==(e=this.scrollbarDimensions)?void 0:e.width)?t:0:this.headersWidthL+=null!=(o=null==(i=this.scrollbarDimensions)?void 0:i.width)?o:0),this.hasFrozenColumns()?(this.headersWidthL=this.headersWidthL+1e3,this.headersWidthR=Math.max(this.headersWidthR,this.viewportW)+this.headersWidthL,this.headersWidthR+=null!=(l=null==(s=this.scrollbarDimensions)?void 0:s.width)?l:0):(this.headersWidthL+=null!=(r=null==(n=this.scrollbarDimensions)?void 0:n.width)?r:0,this.headersWidthL=Math.max(this.headersWidthL,this.viewportW)+1e3),this.headersWidth=this.headersWidthL+this.headersWidthR,Math.max(this.headersWidth,this.viewportW)+1e3}getCanvasWidth(){let e=this.getViewportInnerWidth(),t=this.columns.length;for(this.canvasWidthL=this.canvasWidthR=0;t--;)!this.columns[t]||this.columns[t].hidden||(this.hasFrozenColumns()&&t>this._options.frozenColumn?this.canvasWidthR+=this.columns[t].width||0:this.canvasWidthL+=this.columns[t].width||0);let i=this.canvasWidthL+this.canvasWidthR;if(this._options.fullWidthRows){let t=Math.max(i,e)-i;t>0&&(i+=t,this.hasFrozenColumns()?this.canvasWidthR+=t:this.canvasWidthL+=t)}return i}validateColumnFreezeWidth(e=-1,t){var i,o;if(e>=0){let s=0;this.columns.forEach(((t,i)=>{if(!t.hidden&&i<=e){let{minWidth:e=0,maxWidth:i=0,width:o=this._options.defaultColumnWidth}=t,l=o<e?e:o;i>0&&l>i&&(l=i),s+=l}}));let l=m.width(this._container)||0;if(l>0&&s>l&&!this._options.skipFreezeColumnValidation){if((!1!==t&&!this._invalidfrozenAlerted||!0===t)&&(this._options.invalidColumnFreezeWidthCallback||this._options.throwWhenFrozenNotAllViewable)){if(this._options.throwWhenFrozenNotAllViewable)throw new Error(this._options.invalidColumnFreezeWidthMessage);null==(o=(i=this._options).invalidColumnFreezeWidthCallback)||o.call(i,this._options.invalidColumnFreezeWidthMessage),this._invalidfrozenAlerted=!0}return!1}}return!0}calculateFrozenColumnIndexById(e,t,i=!1){var o;let s=this.getFrozenColumnIdx();if(null!=t||(t=s>=0?null==(o=this.columns[s])?void 0:o.id:void 0),void 0!==t){let o=e.findIndex((e=>e.id===t));if(o>=0&&o!==s)return i&&this.setOptions({frozenColumn:o}),o}return s}validateSetColumnFreeze(e,t){var i,o;let s=this.calculateFrozenColumnIndexById(e);return!(s>=0&&s>e.length-2&&!this._options.skipFreezeColumnValidation)||((!1!==t&&!this._invalidfrozenAlerted||!0===t)&&(null==(o=(i=this._options).invalidColumnFreezePickerCallback)||o.call(i,this._options.invalidColumnFreezePickerMessage),this._invalidfrozenAlerted=!0),!1)}updateCanvasWidth(e){var t,i,o,s,l,n,r,h,a,d,c,u,p;let w=this.canvasWidth,g=this.canvasWidthL,v=this.canvasWidthR;this.canvasWidth=this.getCanvasWidth(),this._options.createTopHeaderPanel&&m.width(this._topHeaderPanel,null!=(t=this._options.topHeaderPanelWidth)?t:this.canvasWidth);let C=this.canvasWidth!==w||this.canvasWidthL!==g||this.canvasWidthR!==v;(C||this.hasFrozenColumns()||this.hasFrozenRows)&&(m.width(this._canvasTopL,this.canvasWidthL),this.getHeadersWidth(),m.width(this._headerL,this.headersWidthL),m.width(this._headerR,this.headersWidthR),this.hasFrozenColumns()?(m.width(this._canvasTopR,this.canvasWidthR),m.width(this._paneHeaderL,this.canvasWidthL),m.setStyleSize(this._paneHeaderR,"left",this.canvasWidthL),m.setStyleSize(this._paneHeaderR,"width",this.viewportW-this.canvasWidthL),m.width(this._paneTopL,this.canvasWidthL),m.setStyleSize(this._paneTopR,"left",this.canvasWidthL),m.width(this._paneTopR,this.viewportW-this.canvasWidthL),m.width(this._headerRowScrollerL,this.canvasWidthL),m.width(this._headerRowScrollerR,this.viewportW-this.canvasWidthL),m.width(this._headerRowL,this.canvasWidthL),m.width(this._headerRowR,this.canvasWidthR),this._options.createFooterRow&&(m.width(this._footerRowScrollerL,this.canvasWidthL),m.width(this._footerRowScrollerR,this.viewportW-this.canvasWidthL),m.width(this._footerRowL,this.canvasWidthL),m.width(this._footerRowR,this.canvasWidthR)),this._options.createPreHeaderPanel&&m.width(this._preHeaderPanel,null!=(i=this._options.preHeaderPanelWidth)?i:this.canvasWidth),m.width(this._viewportTopL,this.canvasWidthL),m.width(this._viewportTopR,this.viewportW-this.canvasWidthL),this.hasFrozenRows&&(m.width(this._paneBottomL,this.canvasWidthL),m.setStyleSize(this._paneBottomR,"left",this.canvasWidthL),m.width(this._viewportBottomL,this.canvasWidthL),m.width(this._viewportBottomR,this.viewportW-this.canvasWidthL),m.width(this._canvasBottomL,this.canvasWidthL),m.width(this._canvasBottomR,this.canvasWidthR))):(m.width(this._paneHeaderL,"100%"),m.width(this._paneTopL,"100%"),m.width(this._headerRowScrollerL,"100%"),m.width(this._headerRowL,this.canvasWidth),this._options.createFooterRow&&(m.width(this._footerRowScrollerL,"100%"),m.width(this._footerRowL,this.canvasWidth)),this._options.createPreHeaderPanel&&m.width(this._preHeaderPanel,null!=(o=this._options.preHeaderPanelWidth)?o:this.canvasWidth),m.width(this._viewportTopL,"100%"),this.hasFrozenRows&&(m.width(this._viewportBottomL,"100%"),m.width(this._canvasBottomL,this.canvasWidthL)))),this.viewportHasHScroll=this.canvasWidth>=this.viewportW-(null!=(l=null==(s=this.scrollbarDimensions)?void 0:s.width)?l:0),m.width(this._headerRowSpacerL,this.canvasWidth+(this.viewportHasVScroll&&null!=(r=null==(n=this.scrollbarDimensions)?void 0:n.width)?r:0)),m.width(this._headerRowSpacerR,this.canvasWidth+(this.viewportHasVScroll&&null!=(a=null==(h=this.scrollbarDimensions)?void 0:h.width)?a:0)),this._options.createFooterRow&&(m.width(this._footerRowSpacerL,this.canvasWidth+(this.viewportHasVScroll&&null!=(c=null==(d=this.scrollbarDimensions)?void 0:d.width)?c:0)),m.width(this._footerRowSpacerR,this.canvasWidth+(this.viewportHasVScroll&&null!=(p=null==(u=this.scrollbarDimensions)?void 0:u.width)?p:0))),(C||e)&&this.applyColumnWidths()}getPreHeaderPanel(){return this._preHeaderPanel}getPreHeaderPanelLeft(){return this._preHeaderPanel}getPreHeaderPanelRight(){return this._preHeaderPanelR}getTopHeaderPanel(){return this._topHeaderPanel}setPaneVisibility(){this.hasFrozenColumns()?(m.show(this._paneHeaderR),m.show(this._paneTopR),this.hasFrozenRows?(m.show(this._paneBottomL),m.show(this._paneBottomR)):(m.hide(this._paneBottomR),m.hide(this._paneBottomL))):(m.hide(this._paneHeaderR),m.hide(this._paneTopR),m.hide(this._paneBottomR),this.hasFrozenRows?m.show(this._paneBottomL):(m.hide(this._paneBottomR),m.hide(this._paneBottomL)))}setOverflow(){if(this._viewportTopL.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"scroll":this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"auto",this._viewportTopL.style.overflowY=!this.hasFrozenColumns()&&this._options.alwaysShowVerticalScroll?"scroll":this.hasFrozenColumns()?(this.hasFrozenRows,"hidden"):this.hasFrozenRows?"scroll":"auto",this._viewportTopR.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"scroll":this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"auto",this._viewportTopR.style.overflowY=this._options.alwaysShowVerticalScroll?"scroll":(this.hasFrozenColumns(),this.hasFrozenRows?"scroll":"auto"),this._viewportBottomL.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"scroll":"auto":(this.hasFrozenRows&&this._options.alwaysAllowHorizontalScroll,"auto"),this._viewportBottomL.style.overflowY=!this.hasFrozenColumns()&&this._options.alwaysShowVerticalScroll?"scroll":this.hasFrozenColumns()?(this.hasFrozenRows,"hidden"):this.hasFrozenRows?"scroll":"auto",this._viewportBottomR.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"scroll":"auto":(this.hasFrozenRows&&this._options.alwaysAllowHorizontalScroll,"auto"),this._viewportBottomR.style.overflowY=this._options.alwaysShowVerticalScroll?"scroll":(this.hasFrozenColumns(),this.hasFrozenRows,"auto"),this._options.viewportClass){let e=m.classNameToList(this._options.viewportClass);this._viewportTopL.classList.add(...e),this._viewportTopR.classList.add(...e),this._viewportBottomL.classList.add(...e),this._viewportBottomR.classList.add(...e)}}createCssRules(){this._style=document.createElement("style"),this._style.nonce=this._options.nonce||"",(this._options.shadowRoot||document.head).appendChild(this._style);let e=this._options.rowHeight-this.cellHeightDiff,t=[`.${this.uid} .slick-group-header-column { left: 1000px; }`,`.${this.uid} .slick-header-column { left: 1000px; }`,`.${this.uid} .slick-top-panel { height: ${this._options.topPanelHeight}px; }`,`.${this.uid} .slick-preheader-panel { height: ${this._options.preHeaderPanelHeight}px; }`,`.${this.uid} .slick-topheader-panel { height: ${this._options.topHeaderPanelHeight}px; }`,`.${this.uid} .slick-headerrow-columns { height: ${this._options.headerRowHeight}px; }`,`.${this.uid} .slick-footerrow-columns { height: ${this._options.footerRowHeight}px; }`,`.${this.uid} .slick-cell { height: ${e}px; }`,`.${this.uid} .slick-row { height: ${this._options.rowHeight}px; }`],i=this._style.sheet;if(i){t.forEach((e=>{i.insertRule(e)}));for(let e=0;e<this.columns.length;e++)!this.columns[e]||this.columns[e].hidden||(i.insertRule(`.${this.uid} .l${e} { }`),i.insertRule(`.${this.uid} .r${e} { }`))}else this.createCssRulesAlternative(t)}createCssRulesAlternative(e){let t=document.createElement("template");t.innerHTML='<style type="text/css" rel="stylesheet" />',this._style=t.content.firstChild,(this._options.shadowRoot||document.head).appendChild(this._style);for(let t=0;t<this.columns.length;t++)!this.columns[t]||this.columns[t].hidden||(e.push(`.${this.uid} .l${t} { }`),e.push(`.${this.uid} .r${t} { }`));this._style.styleSheet?this._style.styleSheet.cssText=e.join(" "):this._style.appendChild(document.createTextNode(e.join(" ")))}getColumnCssRules(e){var t;let i;if(!this.stylesheet){let e=(this._options.shadowRoot||document).styleSheets;for(this._options.devMode&&"number"==typeof(null==(t=this._options.devMode)?void 0:t.ownerNodeIndex)&&this._options.devMode.ownerNodeIndex>=0&&(e[this._options.devMode.ownerNodeIndex].ownerNode=this._style),i=0;i<e.length;i++)if((e[i].ownerNode||e[i].owningElement)===this._style){this.stylesheet=e[i];break}if(!this.stylesheet)throw new Error("SlickGrid Cannot find stylesheet.");this.columnCssRulesL=[],this.columnCssRulesR=[];let o,s,l=this.stylesheet.cssRules||this.stylesheet.rules;for(i=0;i<l.length;i++){let e=l[i].selectorText;(o=/\.l\d+/.exec(e))?(s=parseInt(o[0].substr(2,o[0].length-2),10),this.columnCssRulesL[s]=l[i]):(o=/\.r\d+/.exec(e))&&(s=parseInt(o[0].substr(2,o[0].length-2),10),this.columnCssRulesR[s]=l[i])}}return{left:this.columnCssRulesL[e],right:this.columnCssRulesR[e]}}removeCssRules(){var e;null==(e=this._style)||e.remove(),this.stylesheet=null}getTopPanel(){return this._topPanels[0]}getTopPanels(){return this._topPanels}togglePanelVisibility(e,t,i,o){let s=!1!==o;if(this._options[e]!==i)if(this._options[e]=i,i){if(s)return void m.slideDown(t,this.resizeCanvas.bind(this));m.show(t),this.resizeCanvas()}else{if(s)return void m.slideUp(t,this.resizeCanvas.bind(this));m.hide(t),this.resizeCanvas()}}setTopPanelVisibility(e,t){this.togglePanelVisibility("showTopPanel",this._topPanelScrollers,e,t)}setHeaderRowVisibility(e,t){this.togglePanelVisibility("showHeaderRow",this._headerRowScroller,e,t)}setColumnHeaderVisibility(e,t){this.togglePanelVisibility("showColumnHeader",this._headerScroller,e,t)}setFooterRowVisibility(e,t){this.togglePanelVisibility("showFooterRow",this._footerRowScroller,e,t)}setPreHeaderPanelVisibility(e,t){this.togglePanelVisibility("showPreHeaderPanel",[this._preHeaderPanelScroller,this._preHeaderPanelScrollerR],e,t)}setTopHeaderPanelVisibility(e){this.togglePanelVisibility("showTopHeaderPanel",this._topHeaderPanelScroller,e)}getRowHeight(){return this._options.rowHeight}getRowTop(e){return Math.round(this._options.rowHeight*e-this.offset)}getRowBottom(e){return this.getRowTop(e)+this._options.rowHeight}getRowFromPosition(e){return Math.floor((e+this.offset)/this._options.rowHeight)}appendRowHtml(e,t,i,o,s){let l=this.getDataItem(i),n=i<s&&!l,r="slick-row"+(this.hasFrozenRows&&i<=this._options.frozenRow?" frozen":"")+(n?" loading":"")+(i===this.activeRow&&this._options.showCellSelection?" active":"")+(i%2==1?" odd":" even");l||(r+=` ${this._options.addNewRowCssClass}`);let h=this.getItemMetadaWhenExists(i);null!=h&&h.cssClasses&&(r+=` ${h.cssClasses}`);let a,d=m.createDomElement("div",{className:`ui-widget-content ${r}`,role:"row",dataset:{row:`${i}`}}),c=this.getFrozenRowOffset(i),u=this.getRowTop(i)-c;"transform"===this._options.rowTopOffsetRenderType?d.style.transform=`translateY(${u}px)`:d.style.top=`${u}px`,e.push(d),this.hasFrozenColumns()&&(a=d.cloneNode(!0),t.push(a));let p,w,g,v,C=!0;for(let e=0,t=this.columns.length;e<t;e++){if(C=!0,v=this.columns[e],!v||v.hidden)continue;w=1,g=1,p=null,null!=h&&h.columns&&(p=h.columns[v.id]||h.columns[e],w=(null==p?void 0:p.colspan)||1,g=(null==p?void 0:p.rowspan)||1,"*"===w&&(w=t-e),g>s-i&&(g=s-i)),!this._options.enableCellRowSpan&&g>1&&console.warn('[SlickGrid] Cell "rowspan" is an opt-in grid option because of its small perf hit, you must enable it via the "enableCellRowSpan" grid option.');let n=w;if(!this.getParentRowSpanByCell(i,e)){if(this.columnPosRight[Math.min(t-1,e+n-1)]>o.leftPx){if(!v.alwaysRenderColumn&&this.columnPosLeft[e]>o.rightPx&&(C=!1),C){let t=this.hasFrozenColumns()&&e>this._options.frozenColumn?a:d;this.appendCellHtml(t,i,e,n,g,p,l)}}else(v.alwaysRenderColumn||this.hasFrozenColumns()&&e<=this._options.frozenColumn)&&this.appendCellHtml(d,i,e,n,g,p,l);n>1&&(e+=n-1)}}}appendCellHtml(e,t,i,o,s,l,n){let r=this.columns[i],h=`slick-cell l${i} r${Math.min(this.columns.length-1,i+o-1)}`+(r.cssClass?` ${r.cssClass}`:"")+(s>1?" rowspan":"")+(null!=l&&l.cssClass?` ${l.cssClass}`:"");this.hasFrozenColumns()&&i<=this._options.frozenColumn&&(h+=" frozen"),t===this.activeRow&&i===this.activeCell&&this._options.showCellSelection&&(h+=" active"),Object.keys(this.cellCssClasses).forEach((e=>{var i;null!=(i=this.cellCssClasses[e][t])&&i[r.id]&&(h+=` ${this.cellCssClasses[e][t][r.id]}`)}));let a=null,d="";n&&(a=this.getDataItemValueForColumn(n,r),d=this.getFormatter(t,r)(t,i,a,r,n,this),null==d&&(d=""));let c=this.trigger(this.onBeforeAppendCell,{row:t,cell:i,value:a,dataContext:n}).getReturnValue(),u="string"==typeof c?c:"";null!=d&&d.addClasses&&(u+=m.classNameToList((u?" ":"")+d.addClasses).join(" "));let p=null!=d&&d.toolTip?`${d.toolTip}`:"",w=m.createDomElement("div",{className:m.classNameToList(`${h} ${u||""}`).join(" "),role:"gridcell",tabIndex:-1});w.setAttribute("aria-describedby",this.uid+r.id),p&&w.setAttribute("title",p);let g=this.getCellHeight(t,s);if(s>1&&g!==this._options.rowHeight-this.cellHeightDiff&&(w.style.height=`${g||0}px`),r.hasOwnProperty("cellAttrs")&&r.cellAttrs instanceof Object&&Object.keys(r.cellAttrs).forEach((e=>{r.cellAttrs.hasOwnProperty(e)&&w.setAttribute(e,r.cellAttrs[e])})),n){let e="[object Object]"!==Object.prototype.toString.call(d)?d:d.html||d.text;this.applyHtmlCode(w,e),t===this.selectionBottomRow&&i===this.selectionRightCell&&this._options.showCellSelection&&this.dragReplaceEl.createEl(w)}e.appendChild(w),d.insertElementAfterTarget&&m.insertAfterElement(w,d.insertElementAfterTarget),this.rowsCache[t].cellRenderQueue.push(i),this.rowsCache[t].cellColSpans[i]=o}cleanupRows(e){let t=new Set;if(this._options.enableCellRowSpan)for(let i=e.top,o=e.bottom;i<=o;i++){let e=this.getRowSpanIntersect(i);null!==e&&t.add(e)}Object.keys(this.rowsCache).forEach((i=>{if(this.rowsCache){let o=+i,s=!0;this.hasFrozenRows&&(this._options.frozenBottom&&o>=this.actualFrozenRow||!this._options.frozenBottom&&o<=this.actualFrozenRow)&&(s=!1),(o=parseInt(i,10))!==this.activeRow&&(o<e.top||o>e.bottom)&&s&&!t.has(o)&&this.removeRowFromCache(o)}})),this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup()}invalidate(){this.updateRowCount(),this.invalidateAllRows(),this.render()}invalidateAllRows(){this.currentEditor&&this.makeActiveCellNormal(),"object"==typeof this.rowsCache&&Object.keys(this.rowsCache).forEach((e=>{this.rowsCache&&this.removeRowFromCache(+e)})),this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup()}invalidateRows(e){if(!e||!e.length)return;let t;this.vScrollDir=0;let i=e.length,o=new Set,s=new Set,l=e.length>this._options.maxPartialRowSpanRemap||e.length===this.getDataLength()||this._prevInvalidatedRowsCount+e.length===this.getDataLength();for(let s=0;s<i;s++)if(t=e[s],this.currentEditor&&this.activeRow===t&&this.makeActiveCellNormal(),this.rowsCache[t]&&this.removeRowFromCache(t),this._options.enableCellRowSpan&&!l){o.add(t);let e=this.getRowSpanIntersect(t);null!==e&&o.add(e)}if(this._options.enableCellRowSpan&&!l){for(let e of Array.from(o)){let t=this.getRowSpanColumnIntersects(e);for(let i of t){let t=this.getParentRowSpanByCell(e,i);t&&this._colsWithRowSpanCache[i]&&(this._colsWithRowSpanCache[i].delete(t.range),s.add(t.range.split(":").map(Number)[0]))}}for(let e of Array.from(s))this.remapRowSpanMetadataByRow(e)}this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup(),this._prevInvalidatedRowsCount=e.length}invalidateRow(e){if(e>=0){let t=[e];if(this._options.enableCellRowSpan){let i=this.getRowSpanIntersect(e);null!==i&&t.push(i)}this.invalidateRows(t)}}removeRowFromCache(e){var t;let i=this.rowsCache[e];null!=i&&i.rowNode&&(this.trigger(this.onBeforeRemoveCachedRow,{row:e}),this._options.enableAsyncPostRenderCleanup&&this.postProcessedRows[e]?this.queuePostProcessedRowForCleanup(i,this.postProcessedRows[e],e):null==(t=i.rowNode)||t.forEach((e=>{var t;return null==(t=e.parentElement)?void 0:t.removeChild(e)})),delete this.rowsCache[e],delete this.postProcessedRows[e],this.renderedRows--,this.counter_rows_removed++)}updateCell(e,t){let i=this.getCellNode(e,t);if(!i)return;let o=this.columns[t],s=this.getDataItem(e);if(this.currentEditor&&this.activeRow===e&&this.activeCell===t)this.currentEditor.loadValue(s);else{let l=s?this.getFormatter(e,o)(e,t,this.getDataItemValueForColumn(s,o),o,s,this):"";this.applyFormatResultToCellNode(l,i),this.invalidatePostProcessingResults(e)}}updateRow(e){let t=this.rowsCache[e];if(!t)return;this.ensureCellNodesInRowsCache(e);let i,o=this.getDataItem(e);Object.keys(t.cellNodesByColumnIdx).forEach((s=>{if(!t.cellNodesByColumnIdx.hasOwnProperty(s))return;let l=+s,n=this.columns[l],r=t.cellNodesByColumnIdx[l];e===this.activeRow&&l===this.activeCell&&this.currentEditor?this.currentEditor.loadValue(o):o?(i=this.getFormatter(e,n)(e,l,this.getDataItemValueForColumn(o,n),n,o,this),this.applyFormatResultToCellNode(i,r)):m.emptyElement(r)})),this.invalidatePostProcessingResults(e)}getViewportRowCount(){var e,t;let i=this.getViewportHeight(),o=null!=(t=null==(e=this.getScrollbarDimensions())?void 0:e.height)?t:0;return Math.floor((i-o)/this._options.rowHeight)}getViewportHeight(){var e,t;if((!this._options.autoHeight||-1!==this._options.frozenColumn)&&(this.topPanelH=this._options.showTopPanel?this._options.topPanelHeight+this.getVBoxDelta(this._topPanelScrollers[0]):0,this.headerRowH=this._options.showHeaderRow?this._options.headerRowHeight+this.getVBoxDelta(this._headerRowScroller[0]):0,this.footerRowH=this._options.showFooterRow?this._options.footerRowHeight+this.getVBoxDelta(this._footerRowScroller[0]):0),this._options.autoHeight){let i=this._paneHeaderL.offsetHeight;i+=this._options.showPreHeaderPanel?this._options.preHeaderPanelHeight+this.getVBoxDelta(this._preHeaderPanelScroller):0,i+=this._options.showHeaderRow?this._options.headerRowHeight+this.getVBoxDelta(this._headerRowScroller[0]):0,i+=this._options.showFooterRow?this._options.footerRowHeight+this.getVBoxDelta(this._footerRowScroller[0]):0,i+=this.getCanvasWidth()>this.viewportW&&null!=(t=null==(e=this.scrollbarDimensions)?void 0:e.height)?t:0,this.viewportH=this._options.rowHeight*this.getDataLengthIncludingAddNew()+(-1===this._options.frozenColumn?i:0)}else{let e=getComputedStyle(this._container),t="content-box"!==e.boxSizing?this.getVBoxDelta(this._container):0,i=this._options.createTopHeaderPanel&&this._options.showTopHeaderPanel?this._options.topHeaderPanelHeight+this.getVBoxDelta(this._topHeaderPanelScroller):0,o=this._options.createPreHeaderPanel&&this._options.showPreHeaderPanel?this._options.preHeaderPanelHeight+this.getVBoxDelta(this._preHeaderPanelScroller):0,s=this._options.showColumnHeader?m.toFloat(m.height(this._headerScroller[0])):0;this.viewportH=m.toFloat(e.height)-m.toFloat(e.paddingTop)-m.toFloat(e.paddingBottom)-this.topPanelH-i-o-this.headerRowH-s-this.footerRowH-t}return this.numVisibleRows=Math.ceil(this.viewportH/this._options.rowHeight),this.viewportH}getViewportInnerWidth(){var e;return this.viewportHasVScroll?this.viewportW-((null==(e=this.scrollbarDimensions)?void 0:e.width)||0):this.viewportW}getViewportWidth(){return this.viewportW=parseFloat(m.innerSize(this._container,"width"))||this._options.devMode&&this._options.devMode.containerClientWidth||0,this.viewportW}resizeCanvas(){var e,t,i,o,s,l;if(!this.initialized)return;if(this.paneTopH=0,this.paneBottomH=0,this.viewportTopH=0,this.viewportBottomH=0,this.getViewportWidth(),this.getViewportHeight(),this.hasFrozenRows?this._options.frozenBottom?(this.paneTopH=this.viewportH-this.frozenRowsHeight-(null!=(t=null==(e=this.scrollbarDimensions)?void 0:e.height)?t:0),this.paneBottomH=this.frozenRowsHeight+(null!=(o=null==(i=this.scrollbarDimensions)?void 0:i.height)?o:0)):(this.paneTopH=this.frozenRowsHeight,this.paneBottomH=this.viewportH-this.frozenRowsHeight):this.paneTopH=this.viewportH,this.paneTopH+=this.topPanelH+this.headerRowH+this.footerRowH,this.hasFrozenColumns()&&this._options.autoHeight&&(this.paneTopH+=null!=(l=null==(s=this.scrollbarDimensions)?void 0:s.height)?l:0),this.viewportTopH=this.paneTopH-this.topPanelH-this.headerRowH-this.footerRowH,this._options.autoHeight){if(this.hasFrozenColumns()){let e=this.paneTopH+this._headerScrollerL.offsetHeight;e+=this.getVBoxDelta(this._container),this._options.showPreHeaderPanel&&(e+=this._options.preHeaderPanelHeight),m.height(this._container,e)}this._paneTopL.style.position="relative"}let n=m.height(this._paneHeaderL);n?n+=this._options.showTopHeaderPanel?this._options.topHeaderPanelHeight:0:n=(this._options.showHeaderRow?this._options.headerRowHeight:0)+(this._options.showPreHeaderPanel?this._options.preHeaderPanelHeight:0),m.setStyleSize(this._paneTopL,"top",n||n),m.height(this._paneTopL,this.paneTopH);let h=this._paneTopL.offsetTop+this.paneTopH;if(this._options.autoHeight||m.height(this._viewportTopL,this.viewportTopH),this.hasFrozenColumns()){let e=m.height(this._paneHeaderL);e&&(e+=this._options.showTopHeaderPanel?this._options.topHeaderPanelHeight:0),m.setStyleSize(this._paneTopR,"top",e),m.height(this._paneTopR,this.paneTopH),m.height(this._viewportTopR,this.viewportTopH),this.hasFrozenRows&&(m.setStyleSize(this._paneBottomL,"top",h),m.height(this._paneBottomL,this.paneBottomH),m.setStyleSize(this._paneBottomR,"top",h),m.height(this._paneBottomR,this.paneBottomH),m.height(this._viewportBottomR,this.paneBottomH))}else this.hasFrozenRows&&(m.width(this._paneBottomL,"100%"),m.height(this._paneBottomL,this.paneBottomH),m.setStyleSize(this._paneBottomL,"top",h));this.hasFrozenRows?(m.height(this._viewportBottomL,this.paneBottomH),this._options.frozenBottom?(m.height(this._canvasBottomL,this.frozenRowsHeight),this.hasFrozenColumns()&&m.height(this._canvasBottomR,this.frozenRowsHeight)):(m.height(this._canvasTopL,this.frozenRowsHeight),this.hasFrozenColumns()&&m.height(this._canvasTopR,this.frozenRowsHeight))):m.height(this._viewportTopR,this.viewportTopH),(!this.scrollbarDimensions||!this.scrollbarDimensions.width)&&(this.scrollbarDimensions=this.measureScrollbar()),this._options.autosizeColsMode===r.LegacyForceFit&&this.autosizeColumns(),this.updateRowCount(),this.handleScroll(),this.lastRenderedScrollLeft=-1,this.render()}updateRowCount(){var e,t,i,o;if(!this.initialized)return;let s=this.getDataLength();s>0&&s!==this._prevDataLength&&(this._rowSpanIsCached=!1),this._options.enableCellRowSpan&&!this._rowSpanIsCached&&this.remapAllColumnsRowSpan(),this._prevDataLength=s;let l=this.getDataLengthIncludingAddNew(),n=0,h=this.hasFrozenRows&&!this._options.frozenBottom?m.height(this._canvasBottomL):m.height(this._canvasTopL);n=this.hasFrozenRows?this.getDataLength()-this._options.frozenRow:l+(this._options.leaveSpaceForNewRows?this.numVisibleRows-1:0);let a=m.height(this._viewportScrollContainerY),d=this.viewportHasVScroll;this.viewportHasVScroll=this._options.alwaysShowVerticalScroll||!this._options.autoHeight&&n*this._options.rowHeight>a,this.makeActiveCellNormal();let c=s-1;"object"==typeof this.rowsCache&&Object.keys(this.rowsCache).forEach((e=>{let t=+e;t>c&&this.removeRowFromCache(t)})),this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup(),this.activeCellNode&&this.activeRow>c&&this.resetActiveCell(),h=this.h,this._options.autoHeight?this.h=this._options.rowHeight*n:(this.th=Math.max(this._options.rowHeight*n,a-(null!=(t=null==(e=this.scrollbarDimensions)?void 0:e.height)?t:0)),this.th<this.maxSupportedCssHeight?(this.h=this.ph=this.th,this.n=1,this.cj=0):(this.h=this.maxSupportedCssHeight,this.ph=this.h/100,this.n=Math.floor(this.th/this.ph),this.cj=(this.th-this.h)/(this.n-1))),(this.h!==h||this.enforceFrozenRowHeightRecalc)&&(this.hasFrozenRows&&!this._options.frozenBottom?(m.height(this._canvasBottomL,this.h),this.hasFrozenColumns()&&m.height(this._canvasBottomR,this.h)):(m.height(this._canvasTopL,this.h),m.height(this._canvasTopR,this.h)),this.scrollTop=this._viewportScrollContainerY.scrollTop,this.scrollHeight=this._viewportScrollContainerY.scrollHeight,this.enforceFrozenRowHeightRecalc=!1);let u=this.scrollTop+this.offset<=this.th-a;0===this.th||0===this.scrollTop?this.page=this.offset=0:u?this.scrollTo(this.scrollTop+this.offset):this.scrollTo(this.th-a+(null!=(o=null==(i=this.scrollbarDimensions)?void 0:i.height)?o:0)),this.h!==h&&this._options.autoHeight&&this.resizeCanvas(),this._options.autosizeColsMode===r.LegacyForceFit&&d!==this.viewportHasVScroll&&this.autosizeColumns(),this.updateCanvasWidth(!1)}getViewport(e,t){return this.getVisibleRange(e,t)}getVisibleRange(e,t){return null!=e||(e=this.scrollTop),null!=t||(t=this.scrollLeft),{top:this.getRowFromPosition(e),bottom:this.getRowFromPosition(e+this.viewportH)+1,leftPx:t,rightPx:t+this.viewportW}}getRenderedRange(e,t){let i=this.getVisibleRange(e,t),o=Math.round(this.viewportH/this._options.rowHeight),s=this._options.minRowBuffer;return-1===this.vScrollDir?(i.top-=o,i.bottom+=s):1===this.vScrollDir?(i.top-=s,i.bottom+=o):(i.top-=s,i.bottom+=s),i.top=Math.max(0,i.top),i.bottom=Math.min(this.getDataLengthIncludingAddNew()-1,i.bottom),i.leftPx-=this.viewportW,i.rightPx+=this.viewportW,i.leftPx=Math.max(0,i.leftPx),i.rightPx=Math.min(this.canvasWidth,i.rightPx),i}getRowCache(){return this.rowsCache}ensureCellNodesInRowsCache(e){var t;let i=this.rowsCache[e];if(null!=i&&i.cellRenderQueue.length&&null!=(t=i.rowNode)&&t.length){let e=i.rowNode,t=Array.from(e[0].children);e.length>1&&(t=t.concat(Array.from(e[1].children)));let o=t.length-1;for(;i.cellRenderQueue.length;){let e=i.cellRenderQueue.pop();i.cellNodesByColumnIdx[e]=t[o--]}}}cleanUpCells(e,t){var i,o;if(this.hasFrozenRows&&(this._options.frozenBottom&&t>this.actualFrozenRow||t<=this.actualFrozenRow))return;let s,l,n=this.rowsCache[t],r=[];for(Object.keys(n.cellNodesByColumnIdx).forEach((i=>{var o;if(!n.cellNodesByColumnIdx.hasOwnProperty(i))return;let s=+i;if(s<=this._options.frozenColumn||Array.isArray(this.columns)&&null!=(o=this.columns[s])&&o.alwaysRenderColumn)return;let l=n.cellColSpans[s];(this.columnPosLeft[s]>e.rightPx||this.columnPosRight[Math.min(this.columns.length-1,(s||0)+l-1)]<e.leftPx)&&(t===this.activeRow&&Number(s)===this.activeCell||r.push(s))}));m.isDefined(s=r.pop());)l=n.cellNodesByColumnIdx[s],this._options.enableAsyncPostRenderCleanup&&null!=(i=this.postProcessedRows[t])&&i[s]?this.queuePostProcessedCellForCleanup(l,s,t):null==(o=l.parentElement)||o.removeChild(l),delete n.cellColSpans[s],delete n.cellNodesByColumnIdx[s],this.postProcessedRows[t]&&delete this.postProcessedRows[t][s]}cleanUpAndRenderCells(e){var t;let i,o,s,l,n,r,h=document.createElement("div"),a=[],d=0,c=this.columns.length;for(let n=e.top,r=e.bottom;n<=r;n++){if(i=this.rowsCache[n],!i)continue;this.ensureCellNodesInRowsCache(n),(!this._options.enableCellRowSpan||null===this.getRowSpanIntersect(n))&&this.cleanUpCells(e,n),o=0;let r=this.getItemMetadaWhenExists(n);r=null==r?void 0:r.columns;let u=this.getDataItem(n);for(let a=0,d=c;a<d;a++){if(!this.columns[a]||this.columns[a].hidden)continue;if(this.columnPosLeft[a]>e.rightPx)break;if(m.isDefined(s=i.cellColSpans[a])){a+=s>1?s-1:0;continue}s=1,l=null,r&&(l=r[this.columns[a].id]||r[a],s=null!=(t=null==l?void 0:l.colspan)?t:1,"*"===s&&(s=d-a));let c=s;if(!this.getParentRowSpanByCell(n,a)){if(this.columnPosRight[Math.min(d-1,a+c-1)]>e.leftPx){let e=this.getRowspan(n,a);this.appendCellHtml(h,n,a,c,e,l,u),o++}a+=c>1?c-1:0}}o&&(d+=o,a.push(n))}if(h.children.length)for(;m.isDefined(n=a.pop());){let e;for(i=this.rowsCache[n];m.isDefined(e=i.cellRenderQueue.pop());)r=h.lastChild,r&&(this.hasFrozenColumns()&&e>this._options.frozenColumn?i.rowNode[1].appendChild(r):i.rowNode[0].appendChild(r),i.cellNodesByColumnIdx[e]=r)}}renderRows(e){var t,i,o,s;let l=[],n=[],r=[],h=!1,a=this.getDataLength(),d=new Set,c=new Set;for(let t=e.top,i=e.bottom;t<=i;t++)if(!(this.rowsCache[t]||this.hasFrozenRows&&this._options.frozenBottom&&t===this.getDataLength())){if(this.renderedRows++,r.push(t),c.add(t),this.rowsCache[t]=this.createEmptyCachingRow(),this._options.enableCellRowSpan){let e=this.getRowSpanIntersect(t);null!==e&&c.add(e)}this.appendRowHtml(l,n,t,e,a),d.add(t),this.activeCellNode&&this.activeRow===t&&(h=!0),this.counter_rows_rendered++}let u=this.setDifference(c,d);if(u.size>0&&u.forEach((t=>{this.removeRowFromCache(t),r.push(t),this.rowsCache[t]=this.createEmptyCachingRow(),this.appendRowHtml(l,n,t,e,a)})),r.length){let e=document.createElement("div"),a=document.createElement("div");l.forEach((t=>e.appendChild(t))),n.forEach((e=>a.appendChild(e)));for(let l=0,n=r.length;l<n;l++)this.hasFrozenRows&&r[l]>=this.actualFrozenRow?this.hasFrozenColumns()?null!=(t=this.rowsCache)&&t.hasOwnProperty(r[l])&&e.firstChild&&a.firstChild&&(this.rowsCache[r[l]].rowNode=[e.firstChild,a.firstChild],this._canvasBottomL.appendChild(e.firstChild),this._canvasBottomR.appendChild(a.firstChild)):null!=(i=this.rowsCache)&&i.hasOwnProperty(r[l])&&e.firstChild&&(this.rowsCache[r[l]].rowNode=[e.firstChild],this._canvasBottomL.appendChild(e.firstChild)):this.hasFrozenColumns()?null!=(o=this.rowsCache)&&o.hasOwnProperty(r[l])&&e.firstChild&&a.firstChild&&(this.rowsCache[r[l]].rowNode=[e.firstChild,a.firstChild],this._canvasTopL.appendChild(e.firstChild),this._canvasTopR.appendChild(a.firstChild)):null!=(s=this.rowsCache)&&s.hasOwnProperty(r[l])&&e.firstChild&&(this.rowsCache[r[l]].rowNode=[e.firstChild],this._canvasTopL.appendChild(e.firstChild));h&&(this.activeCellNode=this.getCellNode(this.activeRow,this.activeCell))}}updateRowPositions(){for(let e in this.rowsCache)if(this.rowsCache){let t=e?parseInt(e,10):0,i=this.rowsCache[t].rowNode[0];"transform"===this._options.rowTopOffsetRenderType?i.style.transform=`translateY(${this.getRowTop(t)}px)`:i.style.top=`${this.getRowTop(t)}px`}}render(){if(!this.initialized)return;this.scrollThrottle.dequeue();let e=this.getVisibleRange(),t=this.getRenderedRange();if(this.cleanupRows(t),this.lastRenderedScrollLeft!==this.scrollLeft){if(this.hasFrozenRows){let e=m.extend(!0,{},t);this._options.frozenBottom?(e.top=this.actualFrozenRow,e.bottom=this.getDataLength()):(e.top=0,e.bottom=this._options.frozenRow),this.cleanUpAndRenderCells(e)}this.cleanUpAndRenderCells(t)}this.renderRows(t),this.hasFrozenRows&&(this._options.frozenBottom?this.renderRows({top:this.actualFrozenRow,bottom:this.getDataLength()-1,leftPx:t.leftPx,rightPx:t.rightPx}):this.renderRows({top:0,bottom:this._options.frozenRow-1,leftPx:t.leftPx,rightPx:t.rightPx})),this.postProcessFromRow=e.top,this.postProcessToRow=Math.min(this.getDataLengthIncludingAddNew()-1,e.bottom),this.startPostProcessing(),this.lastRenderedScrollTop=this.scrollTop,this.lastRenderedScrollLeft=this.scrollLeft,this.trigger(this.onRendered,{startRow:e.top,endRow:e.bottom,grid:this})}getFrozenRowOffset(e){let t=0;return t=this.hasFrozenRows?this._options.frozenBottom?e>=this.actualFrozenRow?this.h<this.viewportTopH?this.actualFrozenRow*this._options.rowHeight:this.h:0:e>=this.actualFrozenRow?this.frozenRowsHeight:0:0,t}bindAncestorScrollEvents(){let e=this.hasFrozenRows&&!this._options.frozenBottom?this._canvasBottomL:this._canvasTopL;for(;(e=e.parentNode)!==document.body&&e;)(e===this._viewportTopL||e.scrollWidth!==e.clientWidth||e.scrollHeight!==e.clientHeight)&&(this._boundAncestors.push(e),this._bindingEventService.bind(e,"scroll",this.handleActiveCellPositionChange.bind(this)))}unbindAncestorScrollEvents(){this._boundAncestors.forEach((e=>{this._bindingEventService.unbindByEventName(e,"scroll")})),this._boundAncestors=[]}setScroller(){this.hasFrozenColumns()?(this._headerScrollContainer=this._headerScrollerR,this._headerRowScrollContainer=this._headerRowScrollerR,this._footerRowScrollContainer=this._footerRowScrollerR,this.hasFrozenRows?this._options.frozenBottom?(this._viewportScrollContainerX=this._viewportBottomR,this._viewportScrollContainerY=this._viewportTopR):this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportBottomR:this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportTopR):(this._headerScrollContainer=this._headerScrollerL,this._headerRowScrollContainer=this._headerRowScrollerL,this._footerRowScrollContainer=this._footerRowScrollerL,this.hasFrozenRows?this._options.frozenBottom?(this._viewportScrollContainerX=this._viewportBottomL,this._viewportScrollContainerY=this._viewportTopL):this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportBottomL:this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportTopL)}scrollTo(e){var t,i;e=Math.max(e,0),e=Math.min(e,(this.th||0)-m.height(this._viewportScrollContainerY)+((this.viewportHasHScroll||this.hasFrozenColumns())&&null!=(i=null==(t=this.scrollbarDimensions)?void 0:t.height)?i:0));let o=this.offset;this.offset=Math.round(this.page*(this.cj||0)),this.page=Math.min((this.n||0)-1,Math.floor(e/(this.ph||0)));let s=e-this.offset;if(this.offset!==o){let e=this.getVisibleRange(s);this.cleanupRows(e),this.updateRowPositions()}this.prevScrollTop!==s&&(this.vScrollDir=this.prevScrollTop+o<s+this.offset?1:-1,this.lastRenderedScrollTop=this.scrollTop=this.prevScrollTop=s,this.hasFrozenColumns()&&(this._viewportTopL.scrollTop=s),this.hasFrozenRows&&(this._viewportBottomL.scrollTop=this._viewportBottomR.scrollTop=s),this._viewportScrollContainerY&&(this._viewportScrollContainerY.scrollTop=s),this.trigger(this.onViewportChanged,{}))}handleHeaderRowScroll(){let e=this._headerRowScrollContainer.scrollLeft;e!==this._viewportScrollContainerX.scrollLeft&&(this._viewportScrollContainerX.scrollLeft=e)}handleFooterRowScroll(){let e=this._footerRowScrollContainer.scrollLeft;e!==this._viewportScrollContainerX.scrollLeft&&(this._viewportScrollContainerX.scrollLeft=e)}handlePreHeaderPanelScroll(){this.handleElementScroll(this._preHeaderPanelScroller)}handleTopHeaderPanelScroll(){this.handleElementScroll(this._topHeaderPanelScroller)}handleElementScroll(e){let t=e.scrollLeft;t!==this._viewportScrollContainerX.scrollLeft&&(this._viewportScrollContainerX.scrollLeft=t)}handleScroll(e){return this.scrollHeight=this._viewportScrollContainerY.scrollHeight,this.scrollTop=this._viewportScrollContainerY.scrollTop,this.scrollLeft=this._viewportScrollContainerX.scrollLeft,this._handleScroll(e?"scroll":"system")}_handleScroll(e="system"){let t=this._viewportScrollContainerY.scrollHeight-this._viewportScrollContainerY.clientHeight,i=this._viewportScrollContainerY.scrollWidth-this._viewportScrollContainerY.clientWidth;t=Math.max(0,t),i=Math.max(0,i),this.scrollTop>t&&(this.scrollTop=t,this.scrollHeight=t),this.scrollLeft>i&&(this.scrollLeft=i);let o=Math.abs(this.scrollTop-this.prevScrollTop),s=Math.abs(this.scrollLeft-this.prevScrollLeft);if(s&&(this.prevScrollLeft=this.scrollLeft,this.scrollToX(this.scrollLeft)),o&&!this._options.autoHeight)if(this.vScrollDir=this.prevScrollTop<this.scrollTop?1:-1,this.prevScrollTop=this.scrollTop,"mousewheel"===e&&(this._viewportScrollContainerY.scrollTop=this.scrollTop),this.hasFrozenColumns()&&(this.hasFrozenRows&&!this._options.frozenBottom?this._viewportBottomL.scrollTop=this.scrollTop:this._viewportTopL.scrollTop=this.scrollTop),o<this.viewportH)this.scrollTo(this.scrollTop+this.offset);else{let e=this.offset;this.h===this.viewportH?this.page=0:this.page=Math.min(this.n-1,Math.floor(this.scrollTop*((this.th-this.viewportH)/(this.h-this.viewportH))*(1/this.ph))),this.offset=Math.round(this.page*this.cj),e!==this.offset&&this.invalidateAllRows()}if(s||o){let e=Math.abs(this.lastRenderedScrollLeft-this.scrollLeft),t=Math.abs(this.lastRenderedScrollTop-this.scrollTop);(e>20||t>20)&&(this._options.forceSyncScrolling||t<this.viewportH&&e<this.viewportW?this.render():this.scrollThrottle.enqueue(),this.trigger(this.onViewportChanged,{}))}return this.trigger(this.onScroll,{triggeredBy:e,scrollHeight:this.scrollHeight,scrollLeft:this.scrollLeft,scrollTop:this.scrollTop}),!(!s&&!o)}scrollCellIntoView(e,t,i){if(this.scrollRowIntoView(e,i),t<=this._options.frozenColumn)return;let o=this.getColspan(e,t);this.internalScrollColumnIntoView(this.columnPosLeft[t],this.columnPosRight[t+(o>1?o-1:0)])}internalScrollColumnIntoView(e,t){var i,o;let s=this.scrollLeft+m.width(this._viewportScrollContainerX)-(this.viewportHasVScroll&&null!=(o=null==(i=this.scrollbarDimensions)?void 0:i.width)?o:0);e<this.scrollLeft?(this._viewportScrollContainerX.scrollLeft=e,this.handleScroll(),this.render()):t>s&&(this._viewportScrollContainerX.scrollLeft=Math.min(e,t-this._viewportScrollContainerX.clientWidth),this.handleScroll(),this.render())}scrollColumnIntoView(e){this.internalScrollColumnIntoView(this.columnPosLeft[e],this.columnPosRight[e])}updatePagingStatusFromView(e){this.pagingActive=0!==e.pageSize,this.pagingIsLastPage=e.pageNum===e.totalPages-1}getRowSpanColumnIntersects(e){return this.getRowSpanIntersection(e,"columns")}getRowSpanIntersect(e){return this.getRowSpanIntersection(e)}getRowSpanIntersection(e,t){let i=[],o=null;for(let s=0,l=this.columns.length;s<l;s++){let l=this._colsWithRowSpanCache[s];if(l)for(let n of Array.from(l)){let[l,r]=n.split(":").map(Number);if(e>=l&&e<=r){if("columns"!==t){o=l;break}i.push(s)}}}return"columns"===t?i:o}getParentRowSpanByCell(e,t,i=!0){let o=null,s=this._colsWithRowSpanCache[t]||new Set;for(let t of Array.from(s)){let[s,l]=t.split(":").map(Number);if((i?e>s:e>=s)&&e<=l){o={start:s,end:l,range:t};break}}return o}remapAllColumnsRowSpan(){let e=this.getDataLength();if(e>0){this._colsWithRowSpanCache={};for(let t=0;t<e;t++)this.remapRowSpanMetadataByRow(t);this._rowSpanIsCached=!0}}remapRowSpanMetadataByRow(e){let t=this.getItemMetadaWhenExists(e);null!=t&&t.columns&&Object.keys(t.columns).forEach((i=>{let o=+i,s=t.columns[o],l=+((null==s?void 0:s.colspan)||1),n=+((null==s?void 0:s.rowspan)||1);this.remapRowSpanMetadata(e,o,l,n)}))}remapRowSpanMetadata(e,t,i,o){var s,l,n;if(o>1){let r=`${e}:${e+o-1}`;if(null!=(s=this._colsWithRowSpanCache)[t]||(s[t]=new Set),this._colsWithRowSpanCache[t].add(r),i>1)for(let e=1;e<i;e++)null!=(l=this._colsWithRowSpanCache)[n=t+e]||(l[n]=new Set),this._colsWithRowSpanCache[t+e].add(r)}}createEmptyCachingRow(){return{rowNode:null,cellColSpans:[],cellNodesByColumnIdx:[],cellRenderQueue:[]}}scrollRowIntoView(e,t){var i,o;if(!this.hasFrozenRows||!this._options.frozenBottom&&e>this.actualFrozenRow-1||this._options.frozenBottom&&e<this.actualFrozenRow-1){let s=m.height(this._viewportScrollContainerY),l=this.hasFrozenRows&&!this._options.frozenBottom?e-this._options.frozenRow:e,n=l*this._options.rowHeight,r=(l+1)*this._options.rowHeight-s+(this.viewportHasHScroll&&null!=(o=null==(i=this.scrollbarDimensions)?void 0:i.height)?o:0);(l+1)*this._options.rowHeight>this.scrollTop+s+this.offset?(this.scrollTo(t?n:r),this.render()):l*this._options.rowHeight<this.scrollTop+this.offset&&(this.scrollTo(t?r:n),this.render())}}scrollRowToTop(e){this.scrollTo(e*this._options.rowHeight),this.render()}scrollPage(e){let t=e*this.numVisibleRows,i=this.scrollTop+this._options.rowHeight-1;if(this.scrollTo((this.getRowFromPosition(i)+t)*this._options.rowHeight),this.render(),this._options.enableCellNavigation&&m.isDefined(this.activeRow)){let i=this.activeRow+t,o=this.getDataLengthIncludingAddNew();i>=o&&(i=o-1),i<0&&(i=0);let s=1===e?this.gotoDown(i-1||0,this.activeCell,this.activePosY,this.activePosX):this.gotoUp(i+1,this.activeCell,this.activePosY,this.activePosX);this.navigateToPos(s)}}navigatePageDown(){this.scrollPage(1)}navigatePageUp(){this.scrollPage(-1)}navigateTop(){this.unsetActiveCell(),this.navigateToRow(0)}navigateBottom(){var e,t;let i=this.getDataLength()-1,o=null!=(t=null==(e=this.getParentRowSpanByCell(i,this.activeCell))?void 0:e.start)?t:i;do{if(this._options.enableCellRowSpan&&this.setActiveRow(o),this.navigateToRow(o)&&this.activeCell===this.activePosX||!m.isDefined(this.activeCell))break}while(--o>0)}navigateToRow(e){let t=this.getDataLength();if(!t)return!1;e<0?e=0:e>=t&&(e=t-1),this.scrollCellIntoView(e,0,!0);let i=!m.isDefined(this.activeCell)||!m.isDefined(this.activeRow);if(this._options.enableCellNavigation&&m.isDefined(this.activeRow)){let t=0,o=null,s=this.activePosX;for(;t<=this.activePosX;)this.canCellBeActive(e,t)&&(o=t,(!m.isDefined(this.activeCell)||t===this.activeCell)&&(i=!0)),t+=this.getColspan(e,t);null!==o?(this.setActiveCellInternal(this.getCellNode(e,o)),this.activePosX=s):this.resetActiveCell()}return i}getColspan(e,t){let i=this.getItemMetadaWhenExists(e);if(!i||!i.columns)return 1;t>=this.columns.length&&(t=this.columns.length-1);let o=i.columns[this.columns[t].id]||i.columns[t],s=null==o?void 0:o.colspan;return s="*"===s?this.columns.length-t:s||1,s}queuePostProcessedRowForCleanup(e,t,i){var o;this.postProcessgroupId++,"object"==typeof t&&Object.keys(t).forEach((o=>{t.hasOwnProperty(o)&&this.postProcessedCleanupQueue.push({actionType:"C",groupId:this.postProcessgroupId,node:e.cellNodesByColumnIdx[+o],columnIdx:+o,rowIdx:i})})),e.rowNode||(e.rowNode=[]),this.postProcessedCleanupQueue.push({actionType:"R",groupId:this.postProcessgroupId,node:e.rowNode}),null==(o=e.rowNode)||o.forEach((e=>e.remove()))}queuePostProcessedCellForCleanup(e,t,i){this.postProcessedCleanupQueue.push({actionType:"C",groupId:this.postProcessgroupId,node:e,columnIdx:t,rowIdx:i}),e.remove()}applyFormatResultToCellNode(e,t,i){if(null==e&&(e=""),"[object Object]"!==Object.prototype.toString.call(e))return void this.applyHtmlCode(t,e);let o=e.html||e.text;this.applyHtmlCode(t,o),e.removeClasses&&!i&&t.classList.remove(...m.classNameToList(e.removeClasses)),e.addClasses&&t.classList.add(...m.classNameToList(e.addClasses)),e.toolTip&&t.setAttribute("title",e.toolTip)}startPostProcessing(){this._options.enableAsyncPostRender&&(window.clearTimeout(this.h_postrender),this.h_postrender=window.setTimeout(this.asyncPostProcessRows.bind(this),this._options.asyncPostRenderDelay))}startPostProcessingCleanup(){this._options.enableAsyncPostRenderCleanup&&(window.clearTimeout(this.h_postrenderCleanup),this.h_postrenderCleanup=window.setTimeout(this.asyncPostProcessCleanupRows.bind(this),this._options.asyncPostRenderCleanupDelay))}invalidatePostProcessingResults(e){"object"==typeof this.postProcessedRows[e]&&Object.keys(this.postProcessedRows[e]).forEach((t=>{this.postProcessedRows[e].hasOwnProperty(t)&&(this.postProcessedRows[e][t]="C")})),this.postProcessFromRow=Math.min(this.postProcessFromRow,e),this.postProcessToRow=Math.max(this.postProcessToRow,e),this.startPostProcessing()}asyncPostProcessRows(){let e=this.getDataLength();for(;this.postProcessFromRow<=this.postProcessToRow;){let t=this.vScrollDir>=0?this.postProcessFromRow++:this.postProcessToRow--,i=this.rowsCache[t];if(i&&!(t>=e))return this.postProcessedRows[t]||(this.postProcessedRows[t]={}),this.ensureCellNodesInRowsCache(t),Object.keys(i.cellNodesByColumnIdx).forEach((e=>{if(i.cellNodesByColumnIdx.hasOwnProperty(e)){let o=+e,s=this.columns[o],l=this.postProcessedRows[t][o];if(s.asyncPostRender&&"R"!==l){let e=i.cellNodesByColumnIdx[o];e&&s.asyncPostRender(e,t,this.getDataItem(t),s,"C"===l),this.postProcessedRows[t][o]="R"}}})),void(this.h_postrender=window.setTimeout(this.asyncPostProcessRows.bind(this),this._options.asyncPostRenderDelay))}}asyncPostProcessCleanupRows(){if(this.postProcessedCleanupQueue.length>0){let e=this.postProcessedCleanupQueue[0].groupId;for(;this.postProcessedCleanupQueue.length>0&&this.postProcessedCleanupQueue[0].groupId===e;){let e=this.postProcessedCleanupQueue.shift();if("R"===(null==e?void 0:e.actionType)&&e.node.forEach((e=>{e.remove()})),"C"===(null==e?void 0:e.actionType)){let t=this.columns[e.columnIdx];t.asyncPostRenderCleanup&&e.node&&t.asyncPostRenderCleanup(e.node,e.rowIdx,t)}}this.h_postrenderCleanup=window.setTimeout(this.asyncPostProcessCleanupRows.bind(this),this._options.asyncPostRenderCleanupDelay)}}updateCellCssStylesOnRenderedRows(e,t){let i,o,s;"object"==typeof this.rowsCache&&Object.keys(this.rowsCache).forEach((l=>{this.rowsCache&&(s=null==t?void 0:t[l],o=null==e?void 0:e[l],s&&Object.keys(s).forEach((e=>{(!o||s[e]!==o[e])&&(i=this.getCellNode(+l,this.getColumnIndex(e)),i&&i.classList.remove(s[e]))})),o&&Object.keys(o).forEach((e=>{(!s||s[e]!==o[e])&&(i=this.getCellNode(+l,this.getColumnIndex(e)),i&&i.classList.add(o[e]))})))}))}addCellCssStyles(e,t){if(this.cellCssClasses[e])throw new Error(`SlickGrid addCellCssStyles: cell CSS hash with key "${e}" already exists.`);this.cellCssClasses[e]=t,this.updateCellCssStylesOnRenderedRows(t,null),this.trigger(this.onCellCssStylesChanged,{key:e,hash:t,grid:this})}removeCellCssStyles(e){this.cellCssClasses[e]&&(this.updateCellCssStylesOnRenderedRows(null,this.cellCssClasses[e]),delete this.cellCssClasses[e],this.trigger(this.onCellCssStylesChanged,{key:e,hash:null,grid:this}))}setCellCssStyles(e,t){let i=this.cellCssClasses[e];this.cellCssClasses[e]=t,this.updateCellCssStylesOnRenderedRows(t,i),this.trigger(this.onCellCssStylesChanged,{key:e,hash:t,grid:this})}getCellCssStyles(e){return this.cellCssClasses[e]}flashCell(e,t,i=250){let o=(e,t)=>{t<1||(window.clearTimeout(this._flashCellTimer),this._flashCellTimer=window.setTimeout((()=>{t%2==0?e.classList.add(this._options.cellFlashingCssClass||""):e.classList.remove(this._options.cellFlashingCssClass||""),o(e,t-1)}),i))};if(this.rowsCache[e]){let i=this.getCellNode(e,t);i&&o(i,5)}}highlightRow(e,t){let i=this.rowsCache[e];t||(t=this._options.rowHighlightDuration),Array.isArray(null==i?void 0:i.rowNode)&&this._options.rowHighlightCssClass&&(i.rowNode.forEach((e=>e.classList.add(...m.classNameToList(this._options.rowHighlightCssClass)))),window.clearTimeout(this._highlightRowTimer),this._highlightRowTimer=window.setTimeout((()=>{var e;null==(e=i.rowNode)||e.forEach((e=>e.classList.remove(...m.classNameToList(this._options.rowHighlightCssClass))))}),t))}_getContainerElement(e,t,i){if(!e)return;t||(t=0),i||(i=0);let o="number"==typeof t?t:this.getColumnIndex(t);return e[(this.hasFrozenRows&&i>=this.actualFrozenRow+(this._options.frozenBottom?0:1)?2:0)+(this.hasFrozenColumns()&&o>this._options.frozenColumn?1:0)]}measureScrollbar(){let e="";this._viewport.forEach((t=>e+=t.className));let t=m.createDomElement("div",{className:e,style:{position:"absolute",top:"-10000px",left:"-10000px",overflow:"auto",width:"100px",height:"100px"}},document.body),i=m.createDomElement("div",{style:{width:"200px",height:"200px",overflow:"auto"}},t),o={width:t.offsetWidth-t.clientWidth,height:t.offsetHeight-t.clientHeight};return i.remove(),t.remove(),o}getMaxSupportedCssHeight(){let e=1e6,t=navigator.userAgent.toLowerCase().match(/firefox/)?this._options.ffMaxSupportedCssHeight:this._options.maxSupportedCssHeight,i=m.createDomElement("div",{style:{display:"hidden"}},document.body);for(;;){let o=2*e;m.height(i,o);let s=m.height(i);if(o>t||s!==o)break;e=o}return i.remove(),e}getUID(){return this.uid}getHeaderColumnWidthDiff(){return this.headerColumnWidthDiff}getScrollbarDimensions(){return this.scrollbarDimensions}getDisplayedScrollbarDimensions(){var e,t,i,o;return{width:this.viewportHasVScroll&&null!=(t=null==(e=this.scrollbarDimensions)?void 0:e.width)?t:0,height:this.viewportHasHScroll&&null!=(o=null==(i=this.scrollbarDimensions)?void 0:i.height)?o:0}}getAbsoluteColumnMinWidth(){return this.absoluteColumnMinWidth}getVBoxDelta(e){let t=getComputedStyle(e),i=0;return["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"].forEach((e=>i+=m.toFloat(t[e]))),i}measureCellPaddingAndBorder(){let e=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],t=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],i=this._headers[0];this.headerColumnWidthDiff=this.headerColumnHeightDiff=0,this.cellWidthDiff=this.cellHeightDiff=0;let o=m.createDomElement("div",{className:"ui-state-default slick-state-default slick-header-column",style:{visibility:"hidden"},textContent:"-"},i),s=getComputedStyle(o);"border-box"!==s.boxSizing&&(e.forEach((e=>this.headerColumnWidthDiff+=m.toFloat(s[e]))),t.forEach((e=>this.headerColumnHeightDiff+=m.toFloat(s[e])))),o.remove();let l=m.createDomElement("div",{className:"slick-row"},this._canvas[0]);o=m.createDomElement("div",{className:"slick-cell",id:"",style:{visibility:"hidden"},textContent:"-"},l),s=getComputedStyle(o),"border-box"!==s.boxSizing&&(e.forEach((e=>this.cellWidthDiff+=m.toFloat(s[e]))),t.forEach((e=>this.cellHeightDiff+=m.toFloat(s[e])))),l.remove(),this.absoluteColumnMinWidth=Math.max(this.headerColumnWidthDiff,this.cellWidthDiff)}clearAllTimers(){window.clearTimeout(this._columnResizeTimer),window.clearTimeout(this._executionBlockTimer),window.clearTimeout(this._flashCellTimer),window.clearTimeout(this._highlightRowTimer),window.clearTimeout(this.h_editorLoader)}LogColWidths(){let e="Col Widths:";for(let t=0;t<this.columns.length;t++)e+=" "+(this.columns[t].hidden?"H":this.columns[t].width);console.log(e)}arrayEquals(e,t){return Array.isArray(e)&&Array.isArray(t)&&t.toString()===e.toString()}scrollToX(e){this._viewportScrollContainerX.scrollLeft=e,this._headerScrollContainer.scrollLeft=e,this._topPanelScrollers[0].scrollLeft=e,this._options.createFooterRow&&(this._footerRowScrollContainer.scrollLeft=e),this._options.createPreHeaderPanel&&(this.hasFrozenColumns()?this._preHeaderPanelScrollerR.scrollLeft=e:this._preHeaderPanelScroller.scrollLeft=e),this._options.createTopHeaderPanel&&(this._topHeaderPanelScroller.scrollLeft=e),this.hasFrozenColumns()?(this.hasFrozenRows&&(this._viewportTopR.scrollLeft=e),this._headerRowScrollerR.scrollLeft=e):(this.hasFrozenRows&&(this._viewportTopL.scrollLeft=e),this._headerRowScrollerL.scrollLeft=e)}defaultFormatter(e,t,i){return m.isDefined(i)?(i+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}cellExists(e,t){return!(e<0||e>=this.getDataLength()||t<0||t>=this.columns.length)}getCellFromNode(e){let t=/l\d+/.exec(e.className);if(!t)throw new Error(`SlickGrid getCellFromNode: cannot get cell - ${e.className}`);return parseInt(t[0].substr(1,t[0].length-1),10)}getRowFromNode(e){var t;for(let i in this.rowsCache)if(this.rowsCache)for(let o in this.rowsCache[i].rowNode)if((null==(t=this.rowsCache[i].rowNode)?void 0:t[+o])===e)return i?parseInt(i,10):0;return null}clearTextSelection(){var e;if(null!=(e=document.selection)&&e.empty)try{document.selection.empty()}catch(e){}else if(window.getSelection){let e=window.getSelection();null!=e&&e.removeAllRanges&&e.removeAllRanges()}}disableSelection(e){e.forEach((e=>{e.setAttribute("unselectable","on"),e.style.mozUserSelect="none",this._bindingEventService.bind(e,"selectstart",(()=>!1))}))}getPubSubService(){return this._pubSubService}getCellFromPoint(e,t){let i=this.getRowFromPosition(t),o=0,s=0;for(let t=0;t<this.columns.length&&s<=e;t++)this.columns[t]&&(s+=this.columns[t].width,o++);return o-=1,i<-1&&(i=-1),{row:i,cell:o}}getPluginByName(e){var t;for(let i=this.plugins.length-1;i>=0;i--)if((null==(t=this.plugins[i])?void 0:t.pluginName)===e)return this.plugins[i]}getContainerNode(){return this._container}getCellHeight(e,t){let i=this._options.rowHeight||0;if(t>1){let o=e+t-1;i=this.getRowBottom(o)-this.getRowTop(e)}else{let e=this.getRowHeight();e!==i-this.cellHeightDiff&&(i=e)}return i-=this.cellHeightDiff,Math.ceil(i)}setDifference(e,t){return new Set(Array.from(e).filter((e=>!t.has(e))))}getCellNodeBox(e,t){var i;if(!this.cellExists(e,t))return null;let o=this.getFrozenRowOffset(e),s=this.getRowTop(e)-o,l=s+this._options.rowHeight-1,n=0;for(let e=0;e<t;e++)!this.columns[e]||this.columns[e].hidden||(n+=this.columns[e].width||0,this._options.frozenColumn===e&&(n=0));return{top:s,left:n,bottom:l,right:n+((null==(i=this.columns[t])?void 0:i.width)||0)}}absBox(e){let t={top:e.offsetTop,left:e.offsetLeft,bottom:0,right:0,width:e.offsetWidth,height:e.offsetWidth,visible:!0};t.bottom=t.top+t.height,t.right=t.left+t.width;let i=e.offsetParent;for(;(e=e.parentNode)!==document.body&&e&&e.parentNode;){let o=getComputedStyle(e);t.visible&&e.scrollHeight!==e.offsetHeight&&"visible"!==o.overflowY&&(t.visible=t.bottom>e.scrollTop&&t.top<e.scrollTop+e.clientHeight),t.visible&&e.scrollWidth!==e.offsetWidth&&"visible"!==o.overflowX&&(t.visible=t.right>e.scrollLeft&&t.left<e.scrollLeft+e.clientWidth),t.left-=e.scrollLeft,t.top-=e.scrollTop,e===i&&(t.left+=e.offsetLeft,t.top+=e.offsetTop,i=e.offsetParent),t.bottom=t.top+t.height,t.right=t.left+t.width}return t}getActiveCellPosition(){return this.absBox(this.activeCellNode)}getGridPosition(){return this.absBox(this._container)}getCellEditor(){return this.currentEditor}getActiveCell(){return this.activeCellNode?{row:this.activeRow,cell:this.activeCell}:null}getActiveCellNode(){return this.activeCellNode}getTextSelection(){var e;let t=null;if(window.getSelection){let i=window.getSelection();(null!=(e=null==i?void 0:i.rangeCount)?e:0)>0&&(t=i.getRangeAt(0))}return t}setTextSelection(e){if(window.getSelection&&e){let t=window.getSelection();t&&(t.removeAllRanges(),t.addRange(e))}}sanitizeHtmlString(e,t){if(!this._options.sanitizer||"string"!=typeof e)return e;let i=this._options.sanitizer(e);return!t&&this._options.logSanitizedHtml&&this.logMessageCount<=this.logMessageMaxCount&&i!==e&&(console.log(`sanitizer altered html: ${e} --\x3e ${i}`),this.logMessageCount===this.logMessageMaxCount&&console.log(`sanitizer: silencing messages after first ${this.logMessageMaxCount}`),this.logMessageCount++),i}getRowspan(e,t){let i=1,o=this.getItemMetadaWhenExists(e);return null!=o&&o.columns&&Object.keys(o.columns).forEach((e=>{let s=Number(e);if(s===t){let e=o.columns[s];i=Number((null==e?void 0:e.rowspan)||1)}})),i}findFocusableRow(e,t,i){let o=e,s=this._colsWithRowSpanCache[t]||new Set,l=!1;return Array.from(s).forEach((s=>{let[n,r]=s.split(":").map(Number);!l&&e>=n&&e<=r&&(o="up"===i?n:r,this.canCellBeActive(o,t)&&(l=!0))})),o<0&&(o=0),o}findFirstFocusableCell(e){let t=0,i=e,o=-1;for(;t<this.columns.length;){let s=this.getParentRowSpanByCell(e,t);if(i=null!==s&&s.start!==e?s.start:e,this.canCellBeActive(i,t)){o=t;break}t+=this.getColspan(i,t)}return{cell:o,row:i}}findLastFocusableCell(e){let t=0,i=e,o=-1;for(;t<this.columns.length;){let s=this.getParentRowSpanByCell(e,t);i=null!==s&&s.start!==e?s.start:e,this.canCellBeActive(i,t)&&(o=t),t+=this.getColspan(i,t)}return{cell:o,row:i}}rowsToRanges(e){let t=[],i=this.columns.length-1;for(let o=0;o<e.length;o++)t.push(new d(e[o],0,e[o],i));return t}findSpanStartingCell(e,t){let i=this.getParentRowSpanByCell(e,t),o=null!==i&&i.start!==e?i.start:e,s=0,l=0;for(;s<this.columns.length;){if(s+=this.getColspan(o,s),s>t)return s=l,{cell:s,row:o};l=s}return{cell:s,row:o}}gotoRight(e,t,i,o){if(t>=this.columns.length)return null;let s=t+1,l=i;do{let e=this.findSpanStartingCell(i,s);if(l=e.row,s=e.cell,this.canCellBeActive(l,s)&&s>t)break;s+=this.getColspan(l,e.cell)}while(s<this.columns.length);return s<this.columns.length?{row:l,cell:s,posX:s,posY:i}:null}gotoLeft(e,t,i,o){if(t<=0)return null;let s=this.findFirstFocusableCell(e);if(null===s.cell||s.cell>=t)return null;let l,n={row:e,cell:s.cell,posX:s.cell,posY:i};for(;;){if(l=this.gotoRight(n.row,n.cell,n.posY,n.posX),!l)return null;if(l.cell>=t){let e=this.findFocusableRow(i,n.cell,"up");return e!==n.row&&(n.row=e),n}n=l}}gotoDown(e,t,i,o){let s,l=this.getDataLengthIncludingAddNew();do{for(e+=this.getRowspan(e,o),s=t=0;t<=o;)s=t,t+=this.getColspan(e,t)}while(e<=l&&!this.canCellBeActive(e,s));return e<=l?{row:e,cell:s,posX:o,posY:e}:null}gotoUp(e,t,i,o){let s;if(e<=0)return null;do{for(e=this.findFocusableRow(e-1,o,"up"),s=t=0;t<=o;)s=t,t+=this.getColspan(e,t)}while(e>=0&&!this.canCellBeActive(e,s));return t<=this.columns.length?{row:e,cell:s,posX:o,posY:e}:null}gotoNext(e,t,i,o){var s,l;if(!m.isDefined(e)&&!m.isDefined(t)&&(e=t=i=o=0,this.canCellBeActive(e,t)))return{row:e,cell:t,posX:t,posY:i};let n=this.gotoRight(e,t,i,o);if(!n){let t;for(;!n&&++i<this.getDataLength()+(this._options.enableAddRow?1:0);)t=this.findFirstFocusableCell(i),null!==t.cell&&(n={row:e=null!=(l=null==(s=this.getParentRowSpanByCell(i,t.cell))?void 0:s.start)?l:i,cell:t.cell,posX:t.cell,posY:i})}return n}gotoPrev(e,t,i,o){var s,l;if(!m.isDefined(e)&&!m.isDefined(t)&&(e=i=this.getDataLengthIncludingAddNew()-1,t=o=this.columns.length-1,this.canCellBeActive(e,t)))return{row:e,cell:t,posX:t,posY:i};let n=this.gotoLeft(e,t,i,o);if(!n){let t;for(;!n&&--i>=0;)t=this.findLastFocusableCell(i),t.cell>-1&&(n={row:e=null!=(l=null==(s=this.getParentRowSpanByCell(i,t.cell))?void 0:s.start)?l:i,cell:t.cell,posX:t.cell,posY:i})}return n}gotoRowStart(e,t,i,o){let s=this.findFirstFocusableCell(e);return null===s.cell?null:{row:s.row,cell:s.cell,posX:s.cell,posY:e}}gotoRowEnd(e,t,i,o){let s=this.findLastFocusableCell(e);return-1===s.cell?null:{row:s.row,cell:s.cell,posX:s.cell,posY:e}}navigateRight(){return this.navigate("right")}navigateLeft(){return this.navigate("left")}navigateDown(){return this.navigate("down")}navigateUp(){return this.navigate("up")}navigateNext(){return this.navigate("next")}navigatePrev(){return this.navigate("prev")}navigateRowStart(){return this.navigate("home")}navigateRowEnd(){return this.navigate("end")}navigateTopStart(){return this.navigateToRow(0),this.navigate("home")}navigateBottomEnd(){return this.navigateBottom(),this.navigate("end")}navigate(e){var t;if(!this._options.enableCellNavigation||!this.activeCellNode&&"prev"!==e&&"next"!==e)return!1;if(null==(t=this.getEditorLock())||!t.commitCurrentEdit())return!0;this.setFocus(),this.unsetActiveCell();this.tabbingDirection={up:-1,down:1,left:-1,right:1,prev:-1,next:1,home:-1,end:1}[e];let i={up:this.gotoUp,down:this.gotoDown,left:this.gotoLeft,right:this.gotoRight,prev:this.gotoPrev,next:this.gotoNext,home:this.gotoRowStart,end:this.gotoRowEnd}[e].call(this,this.activeRow,this.activeCell,this.activePosY,this.activePosX);return this.navigateToPos(i)}navigateToPos(e){if(e){if(this.hasFrozenRows&&this._options.frozenBottom&&e.row===this.getDataLength())return;let t=e.row===this.getDataLength();return(!this._options.frozenBottom&&e.row>=this.actualFrozenRow||this._options.frozenBottom&&e.row<this.actualFrozenRow)&&this.scrollCellIntoView(e.row,e.cell,!t&&this._options.emulatePagingWhenScrolling),this.setActiveCellInternal(this.getCellNode(e.row,e.cell)),this.activePosX=e.posX,this.activePosY=e.posY,!0}return this.setActiveCellInternal(this.getCellNode(this.activeRow,this.activeCell)),!1}getCellNode(e,t){if(this.rowsCache[e]){this.ensureCellNodesInRowsCache(e);try{return this.rowsCache[e].cellNodesByColumnIdx.length>t?this.rowsCache[e].cellNodesByColumnIdx[t]:null}catch(i){return this.rowsCache[e].cellNodesByColumnIdx[t]}}return null}setActiveCell(e,t,i,o,s){this.initialized&&(e>this.getDataLength()||e<0||t>=this.columns.length||t<0||this._options.enableCellNavigation&&(this.scrollCellIntoView(e,t,!1),this.setActiveCellInternal(this.getCellNode(e,t),i,o,s)))}setActiveRow(e,t,i){this.initialized&&(e>this.getDataLength()||e<0||(null!=t?t:0)>=this.columns.length||(null!=t?t:0)<0||(this.activeRow=e,i||this.scrollCellIntoView(e,t||0,!1)))}canCellBeActive(e,t){var i,o,s,l;if(!this._options.enableCellNavigation||e>=this.getDataLengthIncludingAddNew()||e<0||t>=this.columns.length||t<0||!this.columns[t]||this.columns[t].hidden||(null!=(o=null==(i=this.getParentRowSpanByCell(e,t))?void 0:i.start)?o:e)!==e)return!1;let n=this.getItemMetadaWhenExists(e);if(void 0!==(null==n?void 0:n.focusable))return!!n.focusable;let r=null==n?void 0:n.columns;return void 0!==(null==(s=null==r?void 0:r[this.columns[t].id])?void 0:s.focusable)?!!r[this.columns[t].id].focusable:void 0!==(null==(l=null==r?void 0:r[t])?void 0:l.focusable)?!!r[t].focusable:!!this.columns[t].focusable}canCellBeSelected(e,t){if(e>=this.getDataLength()||e<0||t>=this.columns.length||t<0||!this.columns[t]||this.columns[t].hidden)return!1;let i=this.getItemMetadaWhenExists(e);if(void 0!==(null==i?void 0:i.selectable))return!!i.selectable;let o=(null==i?void 0:i.columns)&&(i.columns[this.columns[t].id]||i.columns[t]);return void 0!==(null==o?void 0:o.selectable)?!!o.selectable:!!this.columns[t].selectable}gotoCell(e,t,i,o){var s;if(!this.initialized||!this.canCellBeActive(e,t)||null==(s=this.getEditorLock())||!s.commitCurrentEdit())return;this.scrollCellIntoView(e,t,!1);let l=this.getCellNode(e,t),n=this.columns[t],r=!!(this._options.editable&&null!=n&&n.editor&&this._options.suppressActiveCellChangeOnEdit);this.setActiveCellInternal(l,i||e===this.getDataLength()||this._options.autoEdit,null,r,o),this.currentEditor||this.setFocus()}}})})();
/**
 * @license
 * (c) 2009-present Michael Leibman
 * michael{dot}leibman{at}gmail{dot}com
 * http://github.com/mleibman/slickgrid
 *
 * Distributed under MIT license.
 * All rights reserved.
 *
 * SlickGrid v5.17.0
 *
 * NOTES:
 *     Cell/row DOM manipulations are done directly bypassing JS DOM manipulation methods.
 *     This increases the speed dramatically, but can only be done safely because there are no event handlers
 *     or data associated with any cell/row DOM nodes.  Cell editors must make sure they implement .destroy()
 *     and do proper cleanup.
 */
//# sourceMappingURL=/sm/b2e92c710b051296ee191cd7c98c0e62b0332b3bb51391fdc8f004f6ae308338.map